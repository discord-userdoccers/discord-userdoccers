# Billing

Discord supports a variety of payment providers to enable billing for first-party and third-party monetization.

### Payment Source Object

###### Payment Source Structure

| Field                      | Type                                          | Description                                                                       |
| -------------------------- | --------------------------------------------- | --------------------------------------------------------------------------------- |
| id                         | snowflake                                     | The ID of the payment source                                                      |
| brand?                     | string                                        | The brand of the payment source (only applicable for credit cards)                |
| country?                   | string                                        | The country of the payment source                                                 |
| last_4?                    | string                                        | The last four digits of the payment source (only applicable for credit cards)     |
| billing_address ^1^        | [billing address](#billing-address-structure) | The billing address of the payment source                                         |
| type                       | integer                                       | The [type of the payment source](#payment-source-type)                            |
| payment_gateway            | integer                                       | The [payment gateway](#payment-gateway) of the payment source                     |
| payment_gateway_source_id? | string                                        | The ID of the payment source in the payment gateway                               |
| default ^1^                | boolean                                       | Whether the payment source is the default payment source                          |
| invalid                    | boolean                                       | Whether the payment source is invalid                                             |
| flags                      | integer                                       | The [payment source's flags](#payment-source-flags)                               |
| deleted_at                 | ?ISO8601 timestamp                            | When the payment source was deleted at                                            |
| expires_month?             | integer                                       | The month the credit card expires at                                              |
| expires_year?              | integer                                       | The year the credit card expires at                                               |
| email?                     | string                                        | The email address associated with the payment source (only applicable for PayPal) |
| bank?                      | string                                        | The bank associated with the payment source                                       |
| username?                  | string                                        | The username associated with the payment source (only applicable for Venmo)       |

^1^ Not available in payment objects.

###### Example Payment Source

```json
{
  "id": "1422548914485198869",
  "type": 1,
  "invalid": false,
  "flags": 0,
  "deleted_at": null,
  "brand": "visa",
  "last_4": "4242",
  "expires_month": 9,
  "expires_year": 2077,
  "billing_address": {
    "name": "John Doe",
    "line_1": "123 Main Street",
    "line_2": "Apt 4B",
    "city": "San Francisco",
    "state": "CA",
    "country": "US",
    "postal_code": "94105"
  },
  "country": "US",
  "payment_gateway": 1,
  "payment_gateway_source_id": "pm_DwiVlGlYwe1qxLzy4QWChQeo",
  "default": false
}
```

###### Billing Address Structure

| Field        | Type    | Description                                          |
| ------------ | ------- | ---------------------------------------------------- |
| line_1       | string  | The address of the location                          |
| line_2?      | ?string | The secondary address of the location                |
| name         | string  | The name of the payment source                       |
| postal_code? | string  | The postal code of the location                      |
| city         | string  | The city of the location                             |
| state?       | string  | The state or province of the location                |
| country      | string  | The country of the location                          |
| email?       | string  | The email address associated with the payment source |

###### Payment Source Type

| Value | Name         | Description        |
| ----- | ------------ | ------------------ |
| 1     | CARD         | Credit card        |
| 2     | PAYPAL       | PayPal             |
| 3     | GIROPAY      | Giropay            |
| 4     | SOFORT       | Sofort             |
| 5     | PRZELEWY24   | Przelewy24         |
| 6     | SEPA_DEBIT   | SEPA debit         |
| 7     | PAYSAFE_CARD | Paysafe            |
| 8     | GCASH        | GCash              |
| 9     | GRABPAY_MY   | GrabPay (Malaysia) |
| 10    | MOMO_WALLET  | MoMo Wallet        |
| 11    | VENMO        | Venmo              |
| 12    | GOPAY_WALLET | GoPay Wallet       |
| 13    | KAKAOPAY     | KakaoPay           |
| 14    | BANCONTACT   | Bancontact         |
| 15    | EPS          | EPS                |
| 16    | IDEAL        | iDEAL              |
| 17    | CASH_APP     | Cash App           |
| 18    | APPLE        | Apple Pay          |

###### Payment Gateway

| Value | Name          | Description |
| ----- | ------------- | ----------- |
| 1     | STRIPE        | Stripe      |
| 2     | BRAINTREE     | Braintree   |
| 3     | APPLE         | Apple       |
| 4     | GOOGLE        | Google      |
| 5     | ADYEN         | Adyen       |
| 6     | APPLE_PARTNER | Apple Pay   |

###### Payment Source Flags

| Value  | Name               | Description                                             |
| ------ | ------------------ | ------------------------------------------------------- |
| 1 << 0 | NEW                | Payment source is new                                   |
| 1 << 1 | SUCCESSFUL_PAYMENT | Payment source has been successfully used at least once |

### Endpoints

<RouteHeader method="GET" url="/users/@me/billing/country-code">
  Get Billing Country Code
</RouteHeader>

Returns the user's country code based on requesting IP address.

###### Response Body

| Field        | Type   | Description      |
| ------------ | ------ | ---------------- |
| country_code | string | The country code |

<RouteHeader method="GET" url="/users/@me/billing/location-info">
  Get Billing Location Info
</RouteHeader>

###### Response Body

| Field            | Type    | Description          |
| ---------------- | ------- | -------------------- |
| country_code     | string  | The country code     |
| subdivision_code | ?string | The subdivision code |

<RouteHeader method="GET" url="/users/@me/billing/payment-sources">
  Get Payment Sources
</RouteHeader>

Returns a list of [payment source](#payment-source-object) objects. Note that the `billing_address` fields within these objects will be partial for security reasons, containing only `name` and `country`.

<RouteHeader method="GET" url="/users/@me/billing/payment-sources/{payment_source.id}" mfa>
  Get Payment Source
</RouteHeader>

Returns a [payment source](#payment-source-object) object for a given payment source ID.

<RouteHeader method="POST" url="/users/@me/billing/payment-sources">
  Create Payment Source
</RouteHeader>

Creates a payment source. Returns a [payment source](#payment-source-object) object on success. Fires a [User Payment Sources Update](/topics/gateway-events#user-payment-sources-update) Gateway event.

###### JSON Params

| Field                  | Type                                                 | Description                                                                                           |
| ---------------------- | ---------------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| token                  | string                                               | The payment source token retrieved from the payment gateway                                           |
| payment_gateway        | integer                                              | The [payment gateway](#payment-gateway) of the payment source                                         |
| billing_address        | [billing address](#billing-address-structure) object | The billing address of the payment source                                                             |
| billing_address_token? | string                                               | The validation token obtained from the [Validate Billing Address](#validate-billing-address) endpoint |
| return_url?            | string                                               | The URL to return to after the payment source is created                                              |
| bank?                  | string                                               | The bank information for the payment source                                                           |

<RouteHeader method="PATCH" url="/users/@me/billing/payment-sources/{payment_source.id}" mfa>
  Modify Payment Source
</RouteHeader>

Modifies a payment source. Returns an updated [payment source](#payment-source-object) object on success. Fires a [User Payment Sources Update](/topics/gateway-events#user-payment-sources-update) Gateway event.

###### JSON Params

| Field            | Type                                                 | Description                                              |
| ---------------- | ---------------------------------------------------- | -------------------------------------------------------- |
| billing_address? | [billing address](#billing-address-structure) object | The billing address of the payment source                |
| default?         | boolean                                              | Whether the payment source is the default payment source |
| expires_month?   | integer                                              | The year the credit card expires at                      |
| expires_year?    | integer                                              | The month the credit card expires at                     |

<RouteHeader method="DELETE" url="/users/@me/billing/payment-sources/{payment_source.id}">
  Delete Payment Source
</RouteHeader>

Deletes a payment source. Returns a 204 empty response on success. Fires a [User Payment Sources Update](/topics/gateway-events#user-payment-sources-update) Gateway event.

<RouteHeader method="POST" url="/users/@me/billing/payment-sources/validate-billing-address">
  Validate Billing Address
</RouteHeader>

Validates a billing address.

| Field           | Type                                                 | Description                     |
| --------------- | ---------------------------------------------------- | ------------------------------- |
| billing_address | [billing address](#billing-address-structure) object | The billing address to validate |

###### Response Body

| Field | Type   | Description                            |
| ----- | ------ | -------------------------------------- |
| token | string | The token of validated billing address |

<RouteHeader method="POST" url="/users/@me/billing/stripe/setup-intents">
  Get Stripe Setup Intent Secret
</RouteHeader>

Creates a Stripe SetupIntent and returns client secret for it. See the [Stripe documentation](https://docs.stripe.com/api/setup_intents) for more information.

###### Response Body

| Field         | Type   | Description                       |
| ------------- | ------ | --------------------------------- |
| client_secret | string | The client secret of setup intent |

<RouteHeader method="GET" url="/users/@me/billing/adyen/payment-methods">
  Get Available Adyen Payment Methods
</RouteHeader>

Returns available payment methods for the [`ADYEN` payment gateway](#payment-gateway). This endpoint is a proxy for getting available payment methods for transactions using the Adyen API. See the [Adyen documentation](https://docs.adyen.com/api-explorer/Checkout/71/post/paymentMethods) for more information.

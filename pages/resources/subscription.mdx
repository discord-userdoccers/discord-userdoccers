# Subscriptions

Subscriptions in Discord represent an user making recurring payments for at least one SKU over an ongoing period. Successful payments grant the user access to entitlements associated with the SKU.

### Premium Guild Subscription Slot Object

Represents a premium guild subscription slot.

###### Premium Guild Subscription Slot Structure

| Field                      | Type                                                                                     | Description                                                     |
| -------------------------- | ---------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| id                         | snowflake                                                                                | The ID of the premium guild subscription slot                   |
| subscription_id            | snowflake                                                                                | The ID of the subscription                                      |
| canceled                   | boolean                                                                                  | Whether the premium guild subscription slot was canceled        |
| cooldown_ends_at           | ?string                                                                                  | When the cooldown for this premium guild subscription slot ends |
| premium_guild_subscription | ?[premium guild subscription](/resources/guild#premium-guild-subscription-object) object | The premium guild subscription, if the slot was already applied |

###### Example Premium Guild Subscription Slot

```json
{
  "id": "1315132642890350601",
  "subscription_id": "1315132642890350600",
  "canceled": false,
  "cooldown_ends_at": null,
  "premium_guild_subscription": {
    "id": "1315132642890350602",
    "user_id": "673658900435697665",
    "guild_id": "1081635484209520802",
    "ended": false,
    "pause_ends_at": null,
    "user": {
      "id": "673658900435697665",
      "username": "android",
      "global_name": "Android",
      "avatar": "08f104f8d5406c4d46916794fe2efeb7",
      "avatar_decoration_data": {
        "asset": "a_8552f9857793aed0cf816f370e2df3be",
        "sku_id": "1232071712695386162",
        "expires_at": null
      },
      "collectibles": null,
      "discriminator": "0",
      "public_flags": 4194560,
      "primary_guild": null
    }
  }
}
```

### Subscription Object

###### Subscription Structure

| Field                            | Type                                                                               | Description                                                                                                                        |
| -------------------------------- | ---------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| id                               | snowflake                                                                          | The ID of the subscription                                                                                                         |
| type                             | integer                                                                            | The [type](#subscription-type) of subscription                                                                                     |
| payment_gateway                  | ?integer                                                                           | The [payment gateway](/resources/billing#payment-gateway) used to bill the subscription                                            |
| currency                         | string                                                                             | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code                                                   |
| items                            | array[[subscription item](#subscription-item-structure) object]                    | The items in the subscription                                                                                                      |
| payment_gateway_plan_id          | ?string                                                                            | The payment gateway's plan ID for the subscription                                                                                 |
| payment_gateway_subscription_id? | ?string                                                                            | The payment gateway's subscription ID for the subscription                                                                         |
| current_period_start             | ISO8601 timestamp                                                                  | When the current billing period started                                                                                            |
| current_period_end               | ISO8601 timestamp                                                                  | When the current billing period ends                                                                                               |
| streak_started_at?               | ISO8601 timestamp                                                                  | When the current subscription streak started                                                                                       |
| status                           | integer                                                                            | The [status](#subscription-status) of subscription                                                                                 |
| renewal_mutations?               | [subscription renewal mutations](#subscription-renewal-mutations-structure) object | The mutations to the subscription that will occur after renewal                                                                    |
| trial_id?                        | snowflake                                                                          | The ID of the trial the subscription is from                                                                                       |
| payment_source_id                | ?snowflake                                                                         | The ID of the payment source the subscription is paid with                                                                         |
| created_at                       | ISO8601 timestamp                                                                  | When the subscription was created                                                                                                  |
| canceled_at?                     | ISO8601 timestamp                                                                  | When the subscription was canceled (only applicable for [`CANCELED`](#subscription-status) subscriptions)                          |
| country_code                     | ?string                                                                            | The [ISO 3166-1 alpha-2 country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) country code the subscription is billed in |
| trial_ends_at?                   | ISO8601 timestamp                                                                  | When the trial ends                                                                                                                |
| metadata?                        | [subscription metadata](#subscription-metadata-structure) object                   | Extra metadata about the subscription                                                                                              |
| latest_invoice?                  | [subscription invoice](#subscription-invoice-structure) object                     | The latest invoice for the subscription                                                                                            |
| use_storekit_resubscribe         | boolean                                                                            | Whether the subscription should be managed through StoreKit                                                                        |
| price                            | ?integer                                                                           | The price of the subscription (only available for certain third-party subscriptions)                                               |

###### Partial Subscription Structure

| Field                            | Type                                                            | Description                                                                                                    |
| -------------------------------- | --------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| id                               | snowflake                                                       | The ID of the subscription                                                                                     |
| type                             | integer                                                         | The [type](#subscription-type) of subscription                                                                 |
| payment_gateway                  | ?integer                                                        | The [payment gateway](/resources/billing#payment-gateway) used to bill the subscription                        |
| currency                         | string                                                          | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code the subscription is billed in |
| items                            | array[[subscription item](#subscription-item-structure) object] | The items in the subscription                                                                                  |
| payment_gateway_plan_id          | ?string                                                         | The payment gateway's plan ID for the subscription                                                             |
| payment_gateway_subscription_id? | ?string                                                         | The payment gateway's subscription ID for the subscription                                                     |
| current_period_start             | ISO8601 timestamp                                               | When the current billing period started                                                                        |
| current_period_end               | ISO8601 timestamp                                               | When the current billing period ends                                                                           |
| streak_started_at?               | ISO8601 timestamp                                               | When the current subscription streak started                                                                   |

###### Subscription Type

| Value | Name        | Description                                            |
| ----- | ----------- | ------------------------------------------------------ |
| 1     | PREMIUM     | Subscription is a Discord premium (Nitro) subscription |
| 2     | GUILD       | Subscription is a guild role subscription              |
| 3     | APPLICATION | Subscription is an application subscription            |

###### Subscription Status

| Value | Name          | Description                                |
| ----- | ------------- | ------------------------------------------ |
| 0     | UNPAID        | Subscription is unpaid                     |
| 1     | ACTIVE        | Subscription is active                     |
| 2     | PAST_DUE      | Subscription is past due                   |
| 3     | CANCELED      | Subscription is canceled                   |
| 4     | ENDED         | Subscription has ended                     |
| 6     | ACCOUNT_HOLD  | Subscription is on account hold            |
| 7     | BILLING_RETRY | Subscription failed to bill and will retry |
| 8     | PAUSED        | Subscription is paused                     |
| 9     | PAUSE_PENDING | Subscription is pending pause              |

###### Subscription Item Structure

| Field    | Type      | Description                                         |
| -------- | --------- | --------------------------------------------------- |
| id ^1^   | snowflake | The ID of the subscription item                     |
| quantity | integer   | How many of the items have been/are being purchased |
| plan_id  | snowflake | The ID of the plan the item is for                  |

^1^ `id` does not need to be provided when [creating an subscription](#create-subscription).

###### Subscription Renewal Mutations Structure

| Field                    | Type                                                            | Description                                            |
| ------------------------ | --------------------------------------------------------------- | ------------------------------------------------------ |
| payment_gateway_plan_id? | ?string                                                         | The payment gateway's new plan ID for the subscription |
| items?                   | array[[subscription item](#subscription-item-structure) object] | The new items of the subscription                      |

###### Subscription Metadata Structure

| Field                              | Type              | Description                                                                                                        |
| ---------------------------------- | ----------------- | ------------------------------------------------------------------------------------------------------------------ |
| is_egs?                            | boolean           | Unknown                                                                                                            |
| is_holiday_promotion_2021?         | boolean           | Whether the subscription was received from 2021 Holiday promotion                                                  |
| ended_at?                          | string            | When the subscription ended                                                                                        |
| guild_id? **(deprecated)**         | snowflake         | The ID of the guild the subscription's entitlements apply to                                                       |
| application_subscription_guild_id? | snowflake         | The ID of the guild the subscription's entitlements apply to                                                       |
| grace_period_expires_date?         | ISO8601 timestamp | When the grace period expires                                                                                      |
| apple_grace_period_expires_date?   | ISO8601 timestamp | When the grace period expires (only applicable for [`APPLE`](/resources/billing#payment-gateway) payment gateway)  |
| google_grace_period_expires_date?  | ISO8601 timestamp | When the grace period expires (only applicable for [`GOOGLE`](/resources/billing#payment-gateway) payment gateway) |
| google_original_expires_date?      | string            | Unknown                                                                                                            |
| user_trial_offer_id?               | snowflake         | Unknown                                                                                                            |
| user_discount_offer_id?            | snowflake         | Unknown                                                                                                            |
| active_discount_id?                | snowflake         | Unknown                                                                                                            |
| active_discount_expires_at?        | ISO8601 timestamp | Unknown                                                                                                            |

###### Subscription Invoice Structure

| Field                | Type                                                                            | Description                                                                                        |
| -------------------- | ------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| id                   | snowflake                                                                       | The ID of the invoice                                                                              |
| status?              | integer                                                                         | The [status](#subscription-invoice-status) of invoice                                              |
| currency             | string                                                                          | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code the invoice is in |
| subtotal             | integer                                                                         | The subtotal of the invoice                                                                        |
| tax                  | integer                                                                         | The tax applied to the invoice                                                                     |
| total                | integer                                                                         | The total of the invoice                                                                           |
| tax_inclusive        | boolean                                                                         | Whether the subtotal is inclusive of all taxes                                                     |
| items                | array[[subscription invoice item](#subscription-invoice-item-structure) object] | The items in the invoice                                                                           |
| current_period_start | ISO8601 timestamp                                                               | When the current billing period started                                                            |
| current_period_end   | ISO8601 timestamp                                                               | When the current billing period ends                                                               |

###### Subscription Invoice Status

| Value | Name          | Description              |
| ----- | ------------- | ------------------------ |
| 1     | OPEN          | Invoice is open          |
| 2     | PAID          | Invoice is paid          |
| 3     | VOID          | Invoice is void          |
| 4     | UNCOLLECTIBLE | Invoice is uncollectible |

###### Subscription Invoice Item Structure

| Field                   | Type                                                                    | Description                                            |
| ----------------------- | ----------------------------------------------------------------------- | ------------------------------------------------------ |
| id                      | snowflake                                                               | The ID of the invoice item                             |
| quantity                | integer                                                                 | How many of the item have been/are being purchased     |
| amount                  | integer                                                                 | The price of the item (includes discounts)             |
| proration               | boolean                                                                 | Whether the item is prorated                           |
| subscription_plan_id    | snowflake                                                               | The ID of the subscription plan the item represents    |
| subscription_plan_price | integer                                                                 | The price of the subscription plan the item represents |
| discounts               | array[[subscription discount](#subscription-discount-structure) object] | The discounts applied to the item                      |
| sku_id                  | ?snowflake                                                              | The ID of the SKU                                      |
| tenant_metadata?        | map[string, any]                                                        | Extra metadata about the invoice item                  |

^1^ Does not include discounts.

###### Subscription Discount Structure

| Field  | Type    | Description                                         |
| ------ | ------- | --------------------------------------------------- |
| type   | integer | The [type](#subscription-discount-type) of discount |
| amount | integer | How much the discount is                            |

###### Subscription Discount Type

| Value | Name                             | Description                                                       |
| ----- | -------------------------------- | ----------------------------------------------------------------- |
| 1     | SUBSCRIPTION_PLAN                | Discount is from an existing subscription plan’s remaining credit |
| 2     | ENTITLEMENT                      | Discount is from an applied entitlement                           |
| 3     | PREMIUM_LEGACY_UPGRADE_PROMOTION | Discount is from a legacy premium plan promotion discount         |
| 4     | PREMIUM_TRIAL                    | Discount is from a premium trial                                  |
| 5     | DEFAULT                          | Discount is a default discount                                    |

class SubscriptionTrial(TypedDict):
    id: Snowflake
    interval: Literal[1, 2, 3]
    interval_count: int
    sku_id: Snowflake


class SubscriptionPrice(TypedDict):
    currency: str
    amount: int
    exponent: int


class SubscriptionCountryPrice(CountryCode):
    prices: List[SubscriptionPrice]

class SubscriptionPrices(TypedDict):
    country_prices: SubscriptionCountryPrice
    payment_source_prices: Dict[Snowflake, List[SubscriptionPrice]]


class PartialSubscriptionPlan(TypedDict):
    id: Snowflake
    name: str
    sku_id: Snowflake
    interval: Literal[1, 2, 3]
    interval_count: int
    tax_inclusive: bool


class SubscriptionPlan(PartialSubscriptionPlan):
    prices: Dict[Literal[0, 1, 2, 3, 4], SubscriptionPrices]
    price_tier: Literal[None]
    currency: str
    price: int
    discount_price: NotRequired[int]
    fallback_currency: NotRequired[str]
    fallback_price: NotRequired[int]
    fallback_discount_price: NotRequired[int]


## Endpoints

<RouteHeader method="GET" url="/users/@me/guilds/premium/subscriptions/cooldown">
  Get Premium Guild Subscription Cooldown
</RouteHeader>

Returns the cooldown for premium guild subscription slot changes.

###### Response Body

| Field     | Type              | Description                                                                   |
| --------- | ----------------- | ----------------------------------------------------------------------------- |
| ends_at   | ISO8601 timestamp | When the cooldown resets                                                      |
| limit     | integer           | The maximum number of changes that can be made before the cooldown is applied |
| remaining | integer           | The number of changes remaining before the cooldown is applied                |

<RouteHeader method="GET" url="/users/@me/guilds/premium/subscriptions">
  Get Applied Premium Guild Subscriptions
</RouteHeader>

Returns a list of [premium guild subscription](/resources/guild#premium-guild-subscription-object) objects applied by the current user.

###### Query String Params

| Field   | Type    | Description                                                               |
| ------- | ------- | ------------------------------------------------------------------------- |
| paused? | boolean | Whether to return only paused premium guild subscriptions (default false) |

<RouteHeader method="GET" url="/users/@me/guilds/premium/subscription-slots">
  Get Premium Guild Subscription Slots
</RouteHeader>

Returns a list of [premium guild subscription slot](#premium-guild-subscription-slot-object) objects for the current user.

<RouteHeader
  method="POST"
  url="/users/@me/guilds/premium/subscription-slots/{premium_guild_subscription_slot.id}/cancel"
>
  Cancel Premium Guild Subscription Slot
</RouteHeader>

Cancels the given premium guild subscription slot. Returns the canceled [premium guild subscription slot](#premium-guild-subscription-slot-object) object. Fires [User Premium Guild Subscription Slot Update](/topics/gateway-events#user-premium-guild-subscription-slot-update) and optionally [Guild Applied Boosts Update](/topics/gateway-events#guild-applied-boosts-update) Gateway events.

<RouteHeader
  method="POST"
  url="/users/@me/guilds/premium/subscription-slots/{premium_guild_subscription_slot.id}/uncancel"
>
  Uncancel Premium Guild Subscription Slot
</RouteHeader>

Uncancels the given premium guild subscription slot. Returns the uncanceled [premium guild subscription slot](#premium-guild-subscription-slot-object) object. Fires a [User Premium Guild Subscription Slot Update](/topics/gateway-events#user-premium-guild-subscription-slot-update) Gateway event.

<RouteHeader method="GET" url="/users/@me/billing/subscriptions">
  Get User Subscriptions
</RouteHeader>

Returns a list of [subscription](#subscription-object)

###### Query String Params

| Field                    | Type    | Description                                                                                 |
| ------------------------ | ------- | ------------------------------------------------------------------------------------------- |
| include_inactive?        | boolean | Whether to include inactive subscriptions (default false)                                   |
| limit?                   | integer | Max number of subscriptions to return (1-20, default 10)                                    |
| exclude_unpaid_statuses? | boolean | Whether to exclude subscriptions of [`UNPAID`](#subscription-status) status (default false) |
| subscription_type?       | integer | Return only subscriptions with specified [type](#subscription-type)                         |
| sync_level?              | integer | The [sync level](#user-lazy-perk-sync-level)                                                |

###### User Lazy Perk Sync Level

| Value | Name                  | Description            |
| ----- | --------------------- | ---------------------- |
| 0     | NONE                  | Do not resync anything |
| 1     | ADD_PERKS_IF_DETECTED | Add perks if detected  |
| 2     | FULL_RESYNC           | Fully resync perks     |

<RouteHeader method="GET" url="/users/@me/billing/subscriptions/{subscription.id}">
  Get User Subscription
</RouteHeader>

Returns a [subscription](#subscription-object) object for the given subscription ID.

<RouteHeader method="POST" url="/users/@me/billing/subscriptions">
  Create Subscription
</RouteHeader>

Creates a new subscription. Returns a [subscription](#subscription-object) object on success. Fires a [User Subscriptions Update](/topics/gateway-events#user-subscriptions-update) Gateway event.
    
###### JSON Params

| Field                    | Type                                                                                          | Description                                                                      |
| ------------------------ | --------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| items                    | array[[subscription item](#subscription-item-structure) object]                               | The items in the subscription                                                    |
| payment_source_id        | snowflake                                                                                     | The ID of the payment source to pay with                                         |
| currency                 | string                                                                                        | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code |
| trial_id                 | ?snowflake                                                                                    | The ID of the trial to apply to the subscription                                 |
| payment_source_token     | ?string                                                                                       | The token used to authorize with the payment source                              |
| return_url               | ?string                                                                                       | The URL to return to after the payment is complete                               |
| purchase_token           | ?string                                                                                       | The purchase token to use                                                        |
| gateway_checkout_context | ?[gateway checkout context](/resources/entitlement#gateway-checkout-context-structure) object | The context for the gateway checkout, if applicable                              |
| code?                    | string                                                                                        | Unknown                                                                          |
| metadata?                | map[string, any]                                                                              | Extra metadata about the subscription                                            |

<RouteHeader method="PATCH" url="/users/@me/billing/subscriptions/{subscription.id}">
  Modify Subscription
</RouteHeader>

Modifies a subscription. Returns the updated [subscription](#subscription-object) object on success. Fires a [User Subscriptions Update](/topics/gateway-events#user-subscriptions-update) Gateway event.

###### Query String Params

| Field           | Type    | Description |
| --------------- | ------- | ----------- |
| location?       | unknown | Unknown     |
| location_stack? | unknown | Unknown     |

###### JSON Params

| Field                     | Type                                                            | Description                                                                      |
| ------------------------- | --------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| items?                    | array[[subscription item](#subscription-item-structure) object] | The items in the subscription                                                    |
| payment_source_id? ^1^    | snowflake                                                       | The ID of the payment source to pay with                                         |
| payment_source_token? ^1^ | string                                                          | The token used to authorize with the payment source                              |
| currency?                 | string                                                          | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code |
| status?                   | integer                                                         | The [status](#subscription-status) of subscription                               |

^1^ If one of `payment_source_id` or `payment_source_token` was provided, then both must be provided.

<RouteHeader method="DELETE" url="/users/@me/billing/subscriptions/{subscription.id}">
  Delete Subscription
</RouteHeader>

Deletes a subscription. Returns a 204 empty response on success. Fires a [User Subscriptions Update](/topics/gateway-events#user-subscriptions-update) Gateway event.

###### Query String Params

| Field           | Type    | Description |
| --------------- | ------- | ----------- |
| location?       | unknown | Unknown     |
| location_stack? | unknown | Unknown     |

<RouteHeader method="POST" url="/users/@me/billing/subscriptions/preview">
  Preview Subscriptions Update
</RouteHeader>

Previews a new subscription. Returns a [subscription invoice](#subscription-invoice-structure) on success.

###### JSON Params

| Field               | Type                                                            | Description                                                                      |
| ------------------- | --------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| items               | array[[subscription item](#subscription-item-structure) object] | The items in the subscription                                                    |
| currency            | string                                                          | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code |
| payment_source_id   | ?snowflake                                                      | The ID of the payment source to pay with                                         |
| trial_id            | ?snowflake                                                      | The ID of the trial to apply to the subscription                                 |
| apply_entitlements? | boolean                                                         | Whether to apply entitlements (credits) to the previewed subscription            |
| renewal?            | boolean                                                         | Whether the previewed subscription should be a renewal                           |
| code?               | string                                                          | Unknown                                                                          |
| metadata?           | map[string, any]                                                | Extra metadata about the subscription                                            |

<RouteHeader method="GET" url="/users/@me/billing/subscriptions/{subscription.id}/preview">
  Get Subscription Preview
</RouteHeader>

Previews an invoice for the given subscription ID. Returns a [subscription invoice](#subscription-invoice-structure) on success.

<RouteHeader method="PATCH" url="/users/@me/billing/subscriptions/{subscription.id}/preview">
  Preview Subscription Update
</RouteHeader>

Previews an invoice for the given subscription ID. Returns a [subscription invoice](#subscription-invoice-structure) on success.

###### JSON Params

| Field                   | Type                                                            | Description                                                                      |
| ----------------------- | --------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| items?                  | array[[subscription item](#subscription-item-structure) object] | The items the previewed invoice should have                                      |
| payment_source_id?      | snowflake                                                       | The ID of the payment source the previewed invoice should be paid with           |
| currency?               | string                                                          | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code |
| apply_entitlements?     | boolean                                                         | Whether to apply entitlements (credits) to the previewed invoice                 |
| renewal?                | boolean                                                         | Whether the previewed invoice should be a renewal                                |
| user_discount_offer_id? | snowflake                                                       | The ID of the discount offer to apply to the previewed invoice                   |

<RouteHeader method="GET" url="/users/@me/billing/subscriptions/{subscription.id}/invoices">
  Get Subscription Invoices
</RouteHeader>

Returns a list of [subscription invoice](#subscription-invoice-structure) objects for the given subscription ID.

<RouteHeader method="POST" url="/users/@me/billing/subscriptions/{subscription.id}/invoices/{subscription_invoice.id}/pay">
  Pay Subscription Invoice
</RouteHeader>

Pays the subscription invoice. Returns a [subscription](#subscription-object) object on success.

###### JSON Params

| Field                 | Type       | Description                                                                                  |
| --------------------- | ---------- | -------------------------------------------------------------------------------------------- |
| payment_source_id     | ?snowflake | The ID of the payment source the invoice should be paid with                                 |
| payment_source_token? | string     | The token used to authorize with the payment source                                          |
| currency?             | string     | The lower-cased [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) currency code to pay with |
| return_url?           | string     | The URL to return to after the payment is complete                                           |
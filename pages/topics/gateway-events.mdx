# Gateway Events

Gateway connections are WebSockets, meaning they're bidirectional and either side of the WebSocket can send events to the other. The following events are split up into two types:

- **Send events** are Gateway events sent by a client to Discord (like when identifying with the Gateway)
- **Receive events** are Gateway events that are sent by Discord to a client. These events typically represent something happening inside of a guild where the user is a member of, like a channel being updated.

All Gateway events are encapsulated in a [Gateway payload](#gateway-payload-structure).

For more information about interacting with the Gateway, you can reference the [Gateway documentation](/topics/gateway).

### Event Names

In practice, event names are UPPER-CASED with under_scores joining each word in the name. For instance, [Channel Create](#channel-create) would be `CHANNEL_CREATE` and [Voice State Update](#voice-state-update) would be `VOICE_STATE_UPDATE`.

For readability, event names in the following documentation are typically left in Title Case.

### Gateway Payload Structure

Gateway event payloads have a common structure, but the contents of the associated data (`d`) varies between the different events.

| Field | Type        | Description                                                                                                                            |
| ----- | ----------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| op    | integer     | [Gateway OPCode](/topics/opcodes-and-status-codes#gateway-opcodes), which indicates the payload type                                   |
| d     | ?JSON value | Event data                                                                                                                             |
| s?\*  | ?integer    | Sequence number of event used for [resuming sessions](/topics/gateway#resuming) and [heartbeating](/topics/gateway#sending-heartbeats) |
| t?\*  | ?string     | Event name for this payload (`DISPATCH` OPCode only)                                                                                   |

\* These fields are received only, and `null` when the `op` is not `DISPATCH`.

###### Example Gateway Payload (Send)

```json
{
  "op": 2,
  "d": {}
}
```

###### Example Gateway Payload (Receive)

```json
{
  "op": 0,
  "d": {},
  "s": 42,
  "t": "GATEWAY_EVENT_NAME"
}
```

## Send Events

Send events are Gateway events encapsulated in an [event payload](#gateway-payload-structure), and are sent by a client to Discord through a Gateway connection.

| Name                                                      | Description                                                            |
| --------------------------------------------------------- | ---------------------------------------------------------------------- |
| [Identify](#identify)                                     | Trigger the initial handshake with the Gateway                         |
| [Resume](#resume)                                         | Resume a dropped Gateway connection                                    |
| [Heartbeat](#heartbeat)                                   | Maintain an active Gateway connection                                  |
| [Update Presence](#update-presence)                       | Update the client's presence                                           |
| [Update Voice State](#update-voice-state)                 | Join, move, or disconnect the client from a voice channel or call      |
| [Ping Voice Server](#ping-voice-server)                   | Ping the Discord voice servers                                         |
| [Request Guild Members](#request-guild-members)           | Request members for one or more guilds                                 |
| [Request Call Connect](#call-connect)                     | Request a private channels's pre-existing call information             |
| [Update Guild Subscriptions](#update-guild-subscriptions) | Update subscriptions for a guild                                       |
| [Connect Lobby](#connect-lobby)                           | Join a lobby                                                           |
| [Disconnect Lobby](#disconnect-lobby)                     | Leave a lobby                                                          |
| [Update Lobby Voice State](#update-lobby-voice-state)     | Update the client's voice state in a lobby                             |
| [Create Stream](#create-stream)                           | Create a stream for the client (Go Live)                               |
| [Delete Stream](#delete-stream)                           | End a client stream                                                    |
| [Watch Stream](#watch-stream)                             | Watch a user's stream                                                  |
| [Ping Stream](#ping-stream)                               | Ping a user stream's voice server                                      |
| [Set Stream Paused](#set-stream-paused)                   | Pause/resume a client stream                                           |
| [Create Embedded Activity](#launch-embedded-activity)     | Launch an embedded activity in a voice channel or call                 |
| [Update Embedded Activity](#update-embedded-activity)     | Update an embedded activity                                            |
| [Delete Embedded Activity](#delete-embedded-activity)     | Delete an embedded activity                                            |
| [Request Forum Unreads](#request-forum-unreads)           | Request forum channel unread counts                                    |
| [Remote Command](#remote-command)                         | Send a remote command to an embedded (Xbox, PlayStation) voice session |
| [Request Deleted Entity IDs](#request-deleted-entity-ids) | Request deleted entity IDs not matching a given hash for a guild       |
| [Request Soundboard Sounds](#request-soundboard-sounds)   | Request soundboard sounds for one or more guilds                       |
| [Create Speed Test](#create-speed-test)                   | Create a voice speed test                                              |
| [Delete Speed Test](#delete-speed-test)                   | Delete a voice speed test                                              |
| [Request Last Messages](#request-last-messages)           | Request last messages for a guild's channels                           |

#### Identify

Used to trigger the initial handshake with the Gateway.

Details about identifying is in the [Gateway documentation](/topics/gateway#identifying).

###### Identify Structure

| Field            | Type                                                     | Description                                                                                                                                                                                                                                                                     |
| ---------------- | -------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| token            | string                                                   | Authentication token                                                                                                                                                                                                                                                            |
| properties       | [client properties](/reference#client-properties) object | Client and system information                                                                                                                                                                                                                                                   |
| compress?        | boolean                                                  | Whether this connection uses legacy payload compression (default false)                                                                                                                                                                                                         |
| large_threshold? | integer                                                  | Total number of members where, for bots, the Gateway will stop sending offline members in the guild member list, or, for users, stop sending non-stateful events for guilds without a subscription (25-250, default 25 for bots and 250 for users) {/* TODO: Verify default */} |
| shard?           | array[int, int]                                          | The connection's shard (shard_id, num_shards), used for [connection sharding](/topics/gateway#sharding)                                                                                                                                                                         |
| presence?\*      | [update presence](#update-presence-structure) object     | Initial presence information                                                                                                                                                                                                                                                    |
| intents?\*\*     | integer                                                  | The [Gateway intents](/topics/gateway#gateway-intents) you wish to receive                                                                                                                                                                                                      |
| capabilities?    | integer                                                  | The [Gateway capabilities](/topics/gateway#gateway-capabilities) you wish to enable                                                                                                                                                                                             |
| client_state?    | [client state](#client-state-structure) object           | The client's current cache state, used for reducing unneeded information transmission on re-identify                                                                                                                                                                            |

\* For user accounts, the `status` and `activities` specified may not always be respected. The field should only be used when re-identifying, to communicate the last known presence of the user.

\*\* Required for bots on API v8 and above.

###### Example Identify

```json
{
  "op": 2,
  "d": {
    "token": "my_token",
    "properties": {
      "os": "linux",
      "browser": "disco",
      "device": "disco"
    },
    "compress": false,
    "presence": {
      "activities": [],
      "status": "unknown",
      "since": 0,
      "afk": false
    },
    "capabilities": 8189,
    "client_state": {
      "api_code_version": 0,
      "guild_versions": {},
      "highest_last_message_id": "0",
      "private_channels_version": "0",
      "read_state_version": 0,
      "user_guild_settings_version": -1,
      "user_settings_version": -1
    }
  }
}
```

#### Resume

Used to replay missed events when a disconnected client resumes.

Details about resuming are in the [Gateway documentation](/topics/gateway#resuming).

###### Resume Structure

| Field      | Type    | Description                   |
| ---------- | ------- | ----------------------------- |
| token      | string  | Authentication token          |
| session_id | string  | Existing session ID           |
| seq        | integer | Last sequence number received |

###### Example Resume

```json
{
  "op": 6,
  "d": {
    "token": "randomstring",
    "session_id": "evenmorerandomstring",
    "seq": 1337
  }
}
```

#### Heartbeat

Used to maintain an active Gateway connection. Must be sent every `heartbeat_interval` milliseconds after the [Opcode 10 Hello](#hello) payload is received. The inner `d` key is the last sequence number—`s`—received by the client. If you have not yet received one, send `null`. Fires a [Heartbeat ACK](#heartbeat-ack) Gateway event.

Details about heartbeats are in the [Gateway documentation](/topics/gateway#sending-heartbeats).

###### Example Heartbeat

```json
{
  "op": 1,
  "d": 251
}
```

#### Update Presence

Sent by the client to indicate a presence update.

<Alert type="warn">

Clients may only update their presence 5 times per 20 seconds.

</Alert>

<Alert type="warn">

All incoming Gateway events will be paused until the updated presence is propagated.

</Alert>

###### Update Presence Structure

| Field      | Type                                                          | Description                                                                                       |
| ---------- | ------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| activities | array[[activity](/resources/presence#activity-object) object] | The user's activities                                                                             |
| status     | string                                                        | the user's new [status](/resources/presence#status-type)                                          |
| since      | integer                                                       | Unix timestamp (in milliseconds) of when the client went idle, or 0 if it is not                  |
| afk        | boolean                                                       | Whether or not the client is AFK, used to determine whether to dispatch mobile push notifications |

###### Example Update Presence

```json
{
  "op": 3,
  "d": {
    "since": 0,
    "activities": [
      {
        "name": "Save the Oxford Comma",
        "type": 0
      }
    ],
    "status": "online",
    "afk": false
  }
}
```

#### Update Voice State

Sent when a client wants to join, move, or disconnect from a voice channel.

###### Update Voice State Structure

| Field             | Type       | Description                                                                                                  |
| ----------------- | ---------- | ------------------------------------------------------------------------------------------------------------ |
| guild_id          | ?snowflake | The ID of the guild the voice channel is in, if any                                                          |
| channel_id        | ?snowflake | The ID of the voice or private channel the client wants to join (`null` if disconnecting)                    |
| self_mute         | boolean    | Whether the client is muted                                                                                  |
| self_deaf         | boolean    | Whether the client is deafened                                                                               |
| self_video?       | boolean    | Whether the client is streaming video to the channel                                                         |
| preferred_region? | string     | The preferred [voice region](/resources/voice#voice-region-object) ID for the voice channel (not guaranteed) |

###### Example Update Voice State

```json
{
  "op": 4,
  "d": {
    "guild_id": "41771983423143937",
    "channel_id": "127121515262115840",
    "self_mute": false,
    "self_deaf": false,
    "self_video": false
  }
}
```

#### Ping Voice Server

Sent when a client wants to ping a voice server. The inner `d` key should be set to `null`.

###### Example Ping Voice Server

```json
{
  "op": 5,
  "d": null
}
```

#### Request Guild Members

Used to request all members for a guild or a list of guilds. When initially connecting, if you don't have the `GUILD_PRESENCES` [Gateway intent](/topics/gateway#gateway-intents), or if the guild is over 75k members, it will only send members who are in voice, plus the member for you (the connecting user). Otherwise, if a guild has over `large_threshold` members (value in the [Gateway Identify](#identify)), it will only send members who are online, have a role, have a nickname, or are in a voice channel, and if it has under `large_threshold` members, it will send all members. If a client wishes to receive additional members, they need to explicitly request them via this operation. Fires multiple [Guild Members Chunk](#guild-members-chunk) events with up to 1000 members per chunk until all members that match the request have been sent.

Due to our privacy and infrastructural concerns with this feature, there are some limitations that apply:

- For bots, the `GUILD_PRESENCES` privileged intent is required to request presences
- For bots, the `GUILD_MEMBERS` privileged intent is required to request the entire member list (query of "" and limit of 0)
- For users, the `MANAGE_ROLES`, `KICK_MEMBERS`, or `BAN_MEMBERS` permissions are required to request the entire member list (query of "" and limit of 0)
- For bots, only one guild ID may be requested at a time
- Requesting a prefix (`query` parameter) will return a maximum of 100 members
- `user_ids` will be limited to 100 members

###### Request Guild Members Structure

| Field        | Type                             | Description                                                                                     |
| ------------ | -------------------------------- | ----------------------------------------------------------------------------------------------- |
| guild_id     | array[snowflake] \| snowflake    | ID(s) of the guild(s) to get members for                                                        |
| query?\*     | string                           | String that the username/nickname starts with, or an empty string to return all members         |
| limit?\*\*   | integer                          | Maximum number of members to send matching the `query` (0-100, must be 0 with an empty `query`) |
| presences?   | boolean                          | Whether the presence of matched members will be returned                                        |
| user_ids?\*  | snowflake or array of snowflakes | The user IDs to request (max 100)                                                               |
| nonce?\*\*\* | string                           | Nonce to identify the [Guild Members Chunk](#guild-members-chunk) response                      |

\* One of `query` or `user_ids` is required.

\*\* Required when specifying `query`.

\*\*\* The nonce can only be up to 32 bytes. If you send an invalid nonce it will be ignored and the reply member chunk(s) will not have a nonce set.

###### Example Request Guild Members

```json
{
  "op": 8,
  "d": {
    "guild_id": ["41771983444115456"],
    "query": "",
    "limit": 0
  }
}
```

#### Request Call Connect

Used to request a private channel's pre-existing call data, created before the Gateway connection was established. Fires a [Call Create](#call-create) Gateway event if a call is found.

###### Request Call Connect Structure

| Field      | Type      | Description                      |
| ---------- | --------- | -------------------------------- |
| channel_id | snowflake | ID of the DM or group DM channel |

###### Example Request Call Connect

```json
{
  "op": 12,
  "d": {
    "channel_id": "957057010334048288"
  }
}
```

## Receive Events

Received events are Gateway events encapsulated in an [event payload](#gateway-payload-structure), and are sent by Discord to a client through a Gateway connection. Received events correspond to events that happen relevant to the current user and the guilds it is a member of.

| name                                                                              | description                                                                                     |
| --------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- |
| [Hello](#hello)                                                                   | defines the heartbeat interval                                                                  |
| [Heartbeat ACK](#heartbeat-ack)                                                   | response to acknowledge a received client heartbeat                                             |
| [Reconnect](#reconnect)                                                           | server is going away, client should reconnect to Gateway and resume                             |
| [Invalid Session](#invalid-session)                                               | failure response to [Identify](#identify) or [Resume](#resume) or invalid active session        |
| [Ready](#ready)                                                                   | contains the initial state information                                                          |
| [Resumed](#resumed)                                                               | response to [Resume](#resume)                                                                   |
| [Application Command Permissions Update](#application-command-permissions-update) | application command permission was updated                                                      |
| [Channel Create](#channel-create)                                                 | new guild channel created                                                                       |
| [Channel Update](#channel-update)                                                 | channel was updated                                                                             |
| [Channel Delete](#channel-delete)                                                 | channel was deleted                                                                             |
| [Channel Pins Update](#channel-pins-update)                                       | message was pinned or unpinned                                                                  |
| [Thread Create](#thread-create)                                                   | thread created, also sent when being added to a private thread                                  |
| [Thread Update](#thread-update)                                                   | thread was updated                                                                              |
| [Thread Delete](#thread-delete)                                                   | thread was deleted                                                                              |
| [Thread List Sync](#thread-list-sync)                                             | sent when gaining access to a channel, contains all active threads in that channel              |
| [Thread Member Update](#thread-member-update)                                     | [thread member](/resources/channel#thread-member-object) for the current user was updated       |
| [Thread Members Update](#thread-members-update)                                   | some user(s) were added to or removed from a thread                                             |
| [Guild Create](#guild-create)                                                     | lazy-load for unavailable guild, guild became available, or user joined a new guild             |
| [Guild Update](#guild-update)                                                     | guild was updated                                                                               |
| [Guild Delete](#guild-delete)                                                     | guild became unavailable, or user left/was removed from a guild                                 |
| [Guild Audit Log Entry Create](#guild-audit-log-entry-create)                     | guild audit log entry was created                                                               |
| [Guild Ban Add](#guild-ban-add)                                                   | user was banned from a guild                                                                    |
| [Guild Ban Remove](#guild-ban-remove)                                             | user was unbanned from a guild                                                                  |
| [Guild Emojis Update](#guild-emojis-update)                                       | guild emojis were updated                                                                       |
| [Guild Stickers Update](#guild-stickers-update)                                   | guild stickers were updated                                                                     |
| [Guild Integrations Update](#guild-integrations-update)                           | guild integration was updated                                                                   |
| [Guild Member Add](#guild-member-add)                                             | new user joined a guild                                                                         |
| [Guild Member Remove](#guild-member-remove)                                       | user was removed from a guild                                                                   |
| [Guild Member Update](#guild-member-update)                                       | guild member was updated                                                                        |
| [Guild Members Chunk](#guild-members-chunk)                                       | response to [Request Guild Members](#request-guild-members)                                     |
| [Guild Role Create](#guild-role-create)                                           | guild role was created                                                                          |
| [Guild Role Update](#guild-role-update)                                           | guild role was updated                                                                          |
| [Guild Role Delete](#guild-role-delete)                                           | guild role was deleted                                                                          |
| [Guild Scheduled Event Create](#guild-scheduled-event-create)                     | guild scheduled event was created                                                               |
| [Guild Scheduled Event Update](#guild-scheduled-event-update)                     | guild scheduled event was updated                                                               |
| [Guild Scheduled Event Delete](#guild-scheduled-event-delete)                     | guild scheduled event was deleted                                                               |
| [Guild Scheduled Event User Add](#guild-scheduled-event-user-add)                 | user subscribed to a guild scheduled event                                                      |
| [Guild Scheduled Event User Remove](#guild-scheduled-event-user-remove)           | user unsubscribed from a guild scheduled event                                                  |
| [Integration Create](#integration-create)                                         | guild integration was created                                                                   |
| [Integration Update](#integration-update)                                         | guild integration was updated                                                                   |
| [Integration Delete](#integration-delete)                                         | guild integration was deleted                                                                   |
| [Interaction Create](#interaction-create)                                         | user used an interaction, such as an [Application Command](/interactions/application-commands/) |
| [Invite Create](#invite-create)                                                   | invite to a channel was created                                                                 |
| [Invite Delete](#invite-delete)                                                   | invite to a channel was deleted                                                                 |
| [Message Create](#message-create)                                                 | message was created                                                                             |
| [Message Update](#message-update)                                                 | message was edited                                                                              |
| [Message Delete](#message-delete)                                                 | message was deleted                                                                             |
| [Message Delete Bulk](#message-delete-bulk)                                       | multiple messages were deleted at once                                                          |
| [Message Reaction Add](#message-reaction-add)                                     | user reacted to a message                                                                       |
| [Message Reaction Remove](#message-reaction-remove)                               | user removed a reaction from a message                                                          |
| [Message Reaction Remove All](#message-reaction-remove-all)                       | all reactions were explicitly removed from a message                                            |
| [Message Reaction Remove Emoji](#message-reaction-remove-emoji)                   | all reactions for a given emoji were explicitly removed from a message                          |
| [Presence Update](#presence-update)                                               | user was updated                                                                                |
| [Stage Instance Create](#stage-instance-create)                                   | stage instance was created                                                                      |
| [Stage Instance Update](#stage-instance-update)                                   | stage instance was updated                                                                      |
| [Stage Instance Delete](#stage-instance-delete)                                   | stage instance was deleted or closed                                                            |
| [Typing Start](#typing-start)                                                     | user started typing in a channel                                                                |
| [User Update](#user-update)                                                       | properties about the user changed                                                               |
| [Voice State Update](#voice-state-update)                                         | someone joined, left, or moved a voice channel                                                  |
| [Voice Server Update](#voice-server-update)                                       | guild's voice server was updated                                                                |
| [Webhooks Update](#webhooks-update)                                               | guild channel webhook was created, update, or deleted                                           |

#### Hello

Sent on connection to the WebSocket. Defines the heartbeat interval that the client should heartbeat to.

###### Hello Structure

| Field              | Type          | Description                                                                               |
| ------------------ | ------------- | ----------------------------------------------------------------------------------------- |
| \_trace            | array[string] | An array of stringified JSON values representing the connection trace, used for debugging |
| heartbeat_interval | integer       | The interval (in milliseconds) the client should heartbeat at                             |

###### Example Hello

```json
{
  "op": 10,
  "d": {
    "heartbeat_interval": 41250,
    "_trace": ["[\"gateway-prd-us-east1-c-6w69\",{\"micros\":0.0}]"]
  },
  "s": null,
  "t": null
}
```

#### Heartbeat ACK

Sent in response to receiving a heartbeat to acknowledge that it has been received.

Details about heartbeats are in the [Gateway documentation](/topics/gateway#sending-heartbeats).

###### Example Heartbeat ACK

```json
{
  "op": 11,
  "d": null,
  "s": null,
  "t": null
}
```

#### Reconnect

The reconnect event is dispatched when a client should reconnect to the Gateway (and resume their existing session, if they have one). This event usually occurs during deploys to migrate sessions gracefully off old hosts.

###### Example Reconnect

```json
{
  "op": 7,
  "d": null,
  "s": null,
  "t": null
}
```

#### Invalid Session

Sent to indicate one of at least three different situations:

- The Gateway could not initialize a session after receiving an [Opcode 2 Identify](#identify)
- The Gateway could not resume a previous session after receiving an [Opcode 6 Resume](#resume)
- The Gateway has invalidated an active session and is requesting client action

The inner `d` key is a boolean that indicates whether the session may be resumable. See [Connecting](/topics/gateway#connecting) and [Resuming](/topics/gateway#resuming) for more information.

###### Example Invalid Session

```json
{
  "op": 9,
  "d": false,
  "s": null,
  "t": null
}
```

#### Ready

Sent when a client has completed the initial handshake with the Gateway (for new sessions). The Ready event is the largest and most complex event the Gateway will send, as it contains all the state required for a client to begin interacting with the rest of the platform.

###### Ready Structure

| Field                                     | Type                                                                       | Description                                                                                                                                                                                                                                                      |
| ----------------------------------------- | -------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| \_trace                                   | array[string]                                                              | An array of stringified JSON values representing the connection trace, used for debugging                                                                                                                                                                        |
| v                                         | integer                                                                    | [API version](/reference#api-versions)                                                                                                                                                                                                                           |
| user                                      | [user](/resources/user#user-object) object                                 | The connected user                                                                                                                                                                                                                                               |
| user_settings\* \*\*\*\*                  | [user settings](/resources/user-settings#user-settings-object) object      | The client settings for the user                                                                                                                                                                                                                                 |
| user_settings_proto?\*                    | string                                                                     | The base-64 encoded preloaded user settings for the user, (if missing, defaults are used)                                                                                                                                                                        |
| guilds\*\* \*\*\*\*\*\*                   | array[[gateway guild](#gateway-guild-object) object]                       | The guilds the user is in                                                                                                                                                                                                                                        |
| relationships\*                           | array[[relationship](/resources/user#relationship-object)]                 | The relationships the user has with other users                                                                                                                                                                                                                  |
| friend_suggestion_count?\*                | integer                                                                    | The number of friend suggestions the user has                                                                                                                                                                                                                    |
| private_channels\*                        | array[[channel](/resources/channel#channel-object) object]                 | The DMs and group DMs the user is participating in                                                                                                                                                                                                               |
| connected_accounts                        | array[[connection](/resources/user#connection-object)]                     | The third-party accounts the user has linked                                                                                                                                                                                                                     |
| notes\* \*\*\*\*\*                        | map[snowflake, string]                                                     | A mapping of user IDs to notes the user has made for them                                                                                                                                                                                                        |
| presences\*\*\*\*\*\*                     | array[[presence](/resources/presence#presence-object)]                     | The presences of the user's non-offline [friends and implicit relationships](/resources/user#relationship-object)                                                                                                                                                |
| merged_presences\*\*\*\*\*\*              | [merged presences](#merged-presences-structure) object                     | The presences of the user's non-offline [friends and implicit relationships](/resources/user#relationship-object), and any guild presences sent at startup                                                                                                       |
| merged_members\*\*\*\*\*\* \*\*\*\*\*\*\* | array[array[[guild member](/resources/guild#guild-member-object) object]]  | The members of the user's guilds                                                                                                                                                                                                                                 |
| users\*\*\*\*\*\*                         | array[partial [user](/resources/user#user-object) object]                  | The deduped users across all objects in the event                                                                                                                                                                                                                |
| application?                              | [gateway application](#gateway-application-structure) object               | The application of the connected user, if it is a bot                                                                                                                                                                                                            |
| session_id                                | string                                                                     | Unique session ID, used for resuming connections                                                                                                                                                                                                                 |
| session_type                              | string                                                                     | The [type of session](#session-type) that was started                                                                                                                                                                                                            |
| auth_session_id_hash\*                    | string                                                                     | The hash of the auth session ID corresponding to the auth token used to connect                                                                                                                                                                                  |
| auth_token?\* \*\*\*                      | string                                                                     | The refreshed auth token for this user; if present, the client should discard the current auth token and use this in subsequent requests to the API                                                                                                              |
| analytics_token\*                         | string                                                                     | The token used for analytical tracking requests                                                                                                                                                                                                                  |
| required_action?\*                        | string                                                                     | The [action a user is required to take](/resources/user#required-action-type) before continuing to use Discord                                                                                                                                                   |
| country_code\*                            | string                                                                     | The detected [ISO 3166-1 alpha-2 country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) of the user's current IP address                                                                                                                                |
| geo_ordered_rtc_regions                   | array[string]                                                              | A geo-ordered list of [RTC regions](/resources/voice#voice-region-object) that can be used when when setting a voice channel's [`rtc_region`](/resources/channel#channel-object) or [updating the client's voice state](/topics/guild-events#update-voice-state) |
| tutorial\*                                | ?[tutorial](#tutorial-structure) object                                    | The tutorial state of the user, if any                                                                                                                                                                                                                           |
| shard?                                    | array[int, int]                                                            | The [shard information](/topics/gateway#sharding) (shard_id, num_shards) associated with this session, if sharded                                                                                                                                                |
| resume_gateway_url                        | string                                                                     | WebSocket URL for resuming connections                                                                                                                                                                                                                           |
| api_code_version\*                        | integer                                                                    | The API code version, used when re-identifying with client state v2                                                                                                                                                                                              |
| experiments\*                             | array[[user experiment](/resources/experiments#user-experiments) object]   | User experiment rollouts for the user                                                                                                                                                                                                                            |
| guild_experiments\*                       | array[[guild experiment](/resources/experiments#guild-experiments) object] | Guild experiment rollouts for the user                                                                                                                                                                                                                           |

\* Feature is not available to or not tracked for bots. This field may be empty, omitted, or `null`.

\*\* For bots, guilds start out as unavailable when they connect to the Gateway. As they become available, the bot will be notified via [Guild Create](#guild-create) events.

\*\*\* Requires the `AUTH_TOKEN_REFRESH` [Gateway capability](/topics/gateway#gateway-capabilities).

\*\*\*\* Omitted when using the `USER_SETTINGS_PROTO` [Gateway capability](/topics/gateway#gateway-capabilities).

\*\*\*\*\* Omitted when using the `LAZY_USER_NOTES` [Gateway capability](/topics/gateway#gateway-capabilities).

\*\*\*\*\*\* When using the `DEDUPE_USER_OBJECTS` [Gateway capability](/topics/gateway#gateway-capabilities), `presences`, as well as each guild's `presences` array, is replaced by `merged_presences`. In addition, each guild's `members` array will be collapsed into `merged_members`. Finally, the `users` array will contain the user objects for every user in the event. Any user object in the event will be omitted, with an ID left in its place (e.g. `user_id` in [member](/resources/guild#guild-member-object) objects, `recipient_ids` in [private channel](/resources/channel#channel-object) objects, etc.).

\*\*\*\*\*\*\* When using the `PRIORITIZED_READY_PAYLOAD` [Gateway capability](/topics/gateway#gateway-capabilities), `merged_members` in Ready will only include the client's [member](/resources/guild#guild-member-object) object for each guild. The rest will be sent in the [Ready Supplemental](#ready-supplemental) event. See the [gateway guild](#gateway-guild-object) object documentation for more information about included data.

###### Session Type

| Value  | Description             |
| ------ | ----------------------- |
| normal | A normal client session |

###### Merged Presences Structure

| Field    | Type                                                                 | Description                                                                                       |
| -------- | -------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| friends  | array[[presence](/resources/presence#presence-object) object]        | Presences of the user's [friends and implicit relationships](/resources/user#relationship-object) |
| guilds\* | array[array[[presence](/resources/presence#presence-object) object]] | Presences of the user's guilds, in the same order as [the `guilds` array in Ready](#ready)        |

\* See the [gateway guild](#gateway-guild-object) object documentation for more information about included data.

###### Tutorial Structure

| Field                 | Type          | Description                                                |
| --------------------- | ------------- | ---------------------------------------------------------- |
| indicators_suppressed | bool          | Whether the user has suppressed all tutorial indicators    |
| indicators_confirmed  | array[string] | An array of the tutorial indicators the user has confirmed |

###### Gateway Application Structure

| Field | Type      | Description                                                         |
| ----- | --------- | ------------------------------------------------------------------- |
| id    | snowflake | The ID of the application                                           |
| flags | integer   | The [application's flags](/resources/application#application-flags) |

#### Ready Supplemental

Sent soon after [Ready](#ready), with additional data that is not critical to begin interacting with the platform. This event requires the `PRIORITIZED_READY_PAYLOAD` [Gateway capability](/topics/gateway#gateway-capabilities).

If this event is enabled, any fields received in it that are also present in [Ready](#ready) will not be received in [Ready](#ready) (unless otherwise specified).

###### Ready Supplemental Structure

| Field                 | Type                                                              | Description                                                                                                                             |
| --------------------- | ----------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| guilds                | array[[supplemental guild](#supplemental-guild-structure) object] | The guilds the user is in                                                                                                               |
| merged_members        | array[array[[member](/resources/guild#member-object) object]]     | Initial member data for every guild the user is in                                                                                      |
| merged_presences      | [merged presences](#merged-presences-structure) object            | Initial presences for relationships and the user's guilds, in the same order as [the `guilds` array in Ready](#ready)                   |
| lazy_private_channels | array[[channel](/resources/channel#channel-object) object]        | Additional DMs and group DMs the user is participating in, omitted from [Ready](#ready) because they were already in client state cache |
| disclose              | array[string]                                                     | Upcoming changes that the client should disclose to the user                                                                            |

###### Supplemental Guild Structure

<Alert type="warning">

Unavailable guilds will only include the `id` field.

</Alert>

| Field        | Type                                                             | Description                                   |
| ------------ | ---------------------------------------------------------------- | --------------------------------------------- |
| id           | snowflake                                                        | The ID of the guild                           |
| voice_states | array[[voice state](/resources/voice#voice-state-object) object] | States of members currently in voice channels |

#### Resumed

Sent when a client has sent a [resume payload](#resume) to the Gateway (for resuming existing sessions). Signifies the end of event replaying.

###### Resumed Structure

| Field   | Type          | Description                                                                               |
| ------- | ------------- | ----------------------------------------------------------------------------------------- |
| \_trace | array[string] | An array of stringified JSON values representing the connection trace, used for debugging |

###### Example Resumed

```json
{
  "_trace": [
    "[\"gateway-prd-us-east1-c-6w69\",{\"micros\":4493,\"calls\":[\"id_created\",{\"micros\":0,\"calls\":[]},\"session_lookup_time\",{\"micros\":4163,\"calls\":[]},\"session_lookup_finished\",{\"micros\":17,\"calls\":[]},\"discord-sessions-prd-2-31\",{\"micros\":66}]}]"
  ]
}
```

### Application Commands

#### Application Command Permissions Update

Sent when an application command's permissions are updated. The inner payload is an [application command permissions](/interactions/application-commands#guild-application-command-permissions-structure) object.

### Channels

#### Channel Create

Sent when a new guild channel is created, relevant to the current user. The inner payload is a [channel](/resources/channel#channel-object) object.

#### Channel Update

Sent when a channel is updated. The inner payload is a [channel](/resources/channel#channel-object) object. This is not sent when the field `last_message_id` is altered. To keep track of the `last_message_id` changes, you must listen for [Message Create](#message-create) events (or [Thread Create](#thread-create) events for `GUILD_FORUM` channels).

This event may reference roles or guild members that no longer exist in the guild.

#### Channel Delete

Sent when a channel relevant to the current user is deleted. The inner payload is a [channel](/resources/channel#channel-object) object.

#### Thread Create

Sent when a thread is created, relevant to the current user, or when the current user is added to a thread. The inner payload is a [channel](/resources/channel#channel-object) object.

- When a thread is created, includes an additional `newly_created` boolean field.
- When being added to an existing private thread, includes a [thread member](/resources/channel#thread-member-object) object.

#### Thread Update

Sent when a thread is updated. The inner payload is a [channel](/resources/channel#channel-object) object. This is not sent when the field `last_message_id` is altered. To keep track of the `last_message_id` changes, you must listen for [Message Create](#message-create) events.

#### Thread Delete

Sent when a thread relevant to the current user is deleted. The inner payload is a subset of the [channel](/resources/channel#channel-object) object, containing just the `id`, `guild_id`, `parent_id`, and `type` fields.

#### Thread List Sync

Sent when the current user _gains_ access to a channel.

###### Thread List Sync Structure

| Field        | Type                                                                      | Description                                                                                                                                                                                                               |
| ------------ | ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| guild_id     | snowflake                                                                 | the id of the guild                                                                                                                                                                                                       |
| channel_ids? | array of snowflakes                                                       | the parent channel ids whose threads are being synced. If omitted, then threads were synced for the entire guild. This array may contain channel_ids that have no active threads as well, so you know to clear that data. |
| threads      | array of [channel](/resources/channel#channel-object) objects             | all active threads in the given channels that the current user can access                                                                                                                                                 |
| members      | array of [thread member](/resources/channel#thread-member-object) objects | all thread member objects from the synced threads for the current user, indicating which threads the current user has been added to                                                                                       |

#### Thread Member Update

Sent when the [thread member](/resources/channel#thread-member-object) object for the current user is updated. The inner payload is a [thread member](/resources/channel#thread-member-object) object with an extra `guild_id` field. For bots, his event largely is just a signal that you are a member of the thread. See the [threads docs](/topics/threads) for more details.

###### Thread Member Update Structure Extra Fields

| Field    | Type      | Description         |
| -------- | --------- | ------------------- |
| guild_id | snowflake | the id of the guild |

#### Thread Members Update

Sent when anyone is added to or removed from a thread. If the current user does not have the `GUILD_MEMBERS` [Gateway intent](/topics/gateway#gateway-intents), then this event will only be sent if the current user was added to or removed from the thread.

###### Thread Members Update Structure

| Field               | Type                                                                      | Description                                                   |
| ------------------- | ------------------------------------------------------------------------- | ------------------------------------------------------------- |
| id                  | snowflake                                                                 | the id of the thread                                          |
| guild_id            | snowflake                                                                 | the id of the guild                                           |
| member_count        | integer                                                                   | the approximate number of members in the thread, capped at 50 |
| added_members?\*    | array of [thread member](/resources/channel#thread-member-object) objects | the users who were added to the thread                        |
| removed_member_ids? | array of snowflakes                                                       | the id of the users who were removed from the thread          |

\* In this Gateway event, the thread member objects will also include the [guild member](/resources/guild#guild-member-object) and nullable [presence](#presence) objects for each added thread member.

#### Channel Pins Update

Sent when a message is pinned or unpinned in a text channel. This is not sent when a pinned message is deleted.

###### Channel Pins Update Structure

| Field               | Type               | Description                                                 |
| ------------------- | ------------------ | ----------------------------------------------------------- |
| guild_id?           | snowflake          | the id of the guild                                         |
| channel_id          | snowflake          | the id of the channel                                       |
| last_pin_timestamp? | ?ISO8601 timestamp | the time at which the most recent pinned message was pinned |

### Guilds

#### Gateway Guild Object

[Guild](/resources/guild#guild-object) objects received over the Gateway have extended attributes that are not provided in the REST API.

###### Gateway Guild Structure

| Field                      | Type                                                                                                 | Description                                                                                    |
| -------------------------- | ---------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |
| joined_at                  | ISO8601 timestamp                                                                                    | When this guild was joined                                                                     |
| large                      | boolean                                                                                              | Whether this is considered a large guild                                                       |
| unavailable?               | boolean                                                                                              | Whether this guild is unavailable due to an outage                                             |
| member_count               | integer                                                                                              | Total number of members in this guild                                                          |
| voice_states\*\*\*\*       | array[[voice state](/resources/voice#voice-state-object) object]                                     | States of members currently in voice channels                                                  |
| members\*                  | array[[guild member](/resources/guild#guild-member-object) object]                                   | Members in the guild                                                                           |
| channels                   | array[[channel](/resources/channel#channel-object) object]                                           | Channels in the guild                                                                          |
| threads\*\*\*              | array[[channel](/resources/channel#channel-object) object]                                           | All active threads in the guild that current user has permission to view                       |
| presences\*\*              | array[[presence update](#presence-update) object]                                                    | Presences of included guild members; will only include non-offline members for large guilds    |
| stage_instances            | array[[stage instance](/resources/stage-instance#stage-instance-object) object]                      | Stage instances in the guild                                                                   |
| guild_scheduled_events     | array[[guild scheduled event](/resources/guild-scheduled-event#guild-scheduled-event-object) object] | Scheduled events in the guild                                                                  |
| data_mode\*\*\*\*\*        | string                                                                                               | The [data mode](#data-mode) for this object                                                    |
| properties\*\*\*\*\*       | partial [guild](/resources/guild#guild-object) object                                                | The properties of the guild; an otherwise-normal guild object that is missing the below fields |
| stickers                   | array[[sticker](/resources/sticker#sticker-object) object]                                           | Custom guild stickers                                                                          |
| roles                      | array[[role](/topics/permissions#role-object) object]                                                | Roles in the guild                                                                             |
| emojis                     | array[[emoji](/resources/emoji#emoji-object) object]                                                 | Custom guild emojis                                                                            |
| premium_subscription_count | integer                                                                                              | The number of boosts this guild currently has                                                  |

\* If a bot does not have the `GUILD_PRESENCES` [Gateway intent](/topics/gateway#gateway-intents), or if the guild has over 75k members, members and presences returned in this event will only contain your bot and users in voice channels.

\* For bots without the `GUILD_PRESENCES` [Gateway intent](/topics/gateway#gateway-intents), user accounts, or guilds with over 75k members, this will only include the client's member and users in voice channels.

\*\* User accounts only receive presences for non-offline [friends and implicit relationships](/resources/user#relationship-object). Bots with the `GUILD_PRESENCES` [Gateway intent](/topics/gateway#gateway-intents) receive all presences.

\*\*\* User accounts are only synced threads they have been added to. Bots are synced all threads.

\*\*\*\* Omitted when using the `PRIORITIZED_READY_PAYLOAD` [Gateway capability](/topics/gateway#gateway-capabilities).

\*\*\*\*\* Requires the `CLIENT_STATE_V2` [Gateway capability](/topics/gateway#gateway-capabilities). Without the capability, the `properties` field will be merged into the main object, along with the rest of the extended attributes.

###### Data Mode

| Value       | Description                                             |
| ----------- | ------------------------------------------------------- |
| full        | The full guild object is sent                           |
| partial     | Guild data already in the client state cache is omitted |
| unavailable | The guild is unavailable due to an outage               |

#### Guild Create

This event can be sent in three different scenarios:

1.  When a user is initially connecting, to lazily load and backfill information for all unavailable guilds sent in the [Ready](#ready) event. Guilds that are unavailable due to an outage will send a [Guild Delete](#guild-delete) event.
2.  When a Guild becomes available again to the client.
3.  When the current user joins a new Guild.

<Alert type="info">

During an outage, the guild object in scenarios 1 and 3 may be marked as unavailable.

</Alert>

The inner payload can be:

- An available guild: a [Gateway guild](#gateway-guild-object) object.
- An unavailable guild: an [unavailable guild](/resources/guild#unavailable-guild-object) object.

#### Guild Update

Sent when a guild is updated. The inner payload is a [guild](/resources/guild#guild-object) object.

#### Guild Delete

Sent when a guild becomes or was already unavailable due to an outage, or when the user leaves or is removed from a guild. The inner payload is an [unavailable guild](/resources/guild#unavailable-guild-object) object. If the `unavailable` field is not set, the user was removed from the guild.

#### Guild Audit Log Entry Create

Sent when a guild audit log entry is created. The inner payload is an [Audit Log Entry](/resources/audit-log#audit-log-entry-object) object. Requires the `VIEW_AUDIT_LOG` permission.

#### Guild Ban Add

Sent when a user is banned from a guild.

###### Guild Ban Add Structure

| Field    | Type                                               | Description     |
| -------- | -------------------------------------------------- | --------------- |
| guild_id | snowflake                                          | id of the guild |
| user     | partial [user](/resources/user#user-object) object | the banned user |

#### Guild Ban Remove

Sent when a user is unbanned from a guild.

###### Guild Ban Remove Structure

| Field    | Type                                               | Description       |
| -------- | -------------------------------------------------- | ----------------- |
| guild_id | snowflake                                          | id of the guild   |
| user     | partial [user](/resources/user#user-object) object | the unbanned user |

#### Guild Emojis Update

Sent when a guild's emojis have been updated.

###### Guild Emojis Update Structure

| Field    | Type      | Description                                      |
| -------- | --------- | ------------------------------------------------ |
| guild_id | snowflake | id of the guild                                  |
| emojis   | array     | array of [emojis](/resources/emoji#emoji-object) |

#### Guild Stickers Update

Sent when a guild's stickers have been updated.

###### Guild Stickers Update Structure

| Field    | Type      | Description                                            |
| -------- | --------- | ------------------------------------------------------ |
| guild_id | snowflake | id of the guild                                        |
| stickers | array     | array of [stickers](/resources/sticker#sticker-object) |

#### Guild Integrations Update

Sent when a guild integration is updated.

###### Guild Integrations Update Structure

| Field    | Type      | Description                                     |
| -------- | --------- | ----------------------------------------------- |
| guild_id | snowflake | id of the guild whose integrations were updated |

#### Guild Member Add

<Alert type="warn">

If using [Gateway Intents](/topics/gateway#gateway-intents), the `GUILD_MEMBERS` intent will be required to receive this event.

</Alert>

Sent when a new user joins a guild. The inner payload is a [guild member](/resources/guild#guild-member-object) object with an extra `guild_id` key:

###### Guild Member Add Extra Fields

| Field    | Type      | Description     |
| -------- | --------- | --------------- |
| guild_id | snowflake | id of the guild |

#### Guild Member Remove

<Alert type="warn">

If using [Gateway Intents](/topics/gateway#gateway-intents), the `GUILD_MEMBERS` intent will be required to receive this event.

</Alert>

Sent when a user is removed from a guild (leave/kick/ban).

###### Guild Member Remove Structure

| Field    | Type                                         | Description              |
| -------- | -------------------------------------------- | ------------------------ |
| guild_id | snowflake                                    | the id of the guild      |
| user     | a [user](/resources/user#user-object) object | the user who was removed |

#### Guild Member Update

<Alert type="warn">

If using [Gateway Intents](/topics/gateway#gateway-intents), the `GUILD_MEMBERS` intent will be required to receive this event.

</Alert>

Sent when a guild member is updated. This will also fire when the user object of a guild member changes.

###### Guild Member Update Structure

| Field                         | Type                                               | Description                                                                                                                                                                                                                          |
| ----------------------------- | -------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| guild_id                      | snowflake                                          | the id of the guild                                                                                                                                                                                                                  |
| roles                         | array of snowflakes                                | user role ids                                                                                                                                                                                                                        |
| user                          | partial [user](/resources/user#user-object) object | the user                                                                                                                                                                                                                             |
| nick?                         | ?string                                            | nickname of the user in the guild                                                                                                                                                                                                    |
| avatar                        | ?string                                            | the member's [guild avatar hash](/reference#cdm-formatting)                                                                                                                                                                          |
| joined_at                     | ?ISO8601 timestamp                                 | when the user joined the guild                                                                                                                                                                                                       |
| premium_since?                | ?ISO8601 timestamp                                 | when the user starting [boosting](https://support.discord.com/hc/en-us/articles/360028038352-Server-Boosting-) the guild                                                                                                             |
| deaf?                         | boolean                                            | whether the user is deafened in voice channels                                                                                                                                                                                       |
| mute?                         | boolean                                            | whether the user is muted in voice channels                                                                                                                                                                                          |
| pending?                      | boolean                                            | whether the user has not yet passed the guild's [Membership Screening](/resources/guild#membership-screening-object) requirements                                                                                                    |
| communication_disabled_until? | ?ISO8601 timestamp                                 | when the user's [timeout](https://support.discord.com/hc/en-us/articles/4413305239191-Time-Out-FAQ) will expire and the user will be able to communicate in the guild again, null or a time in the past if the user is not timed out |

#### Guild Members Chunk

Sent in response to [Guild Request Members](#request-guild-members).
You can use the `chunk_index` and `chunk_count` to calculate how many chunks are left for your request.

###### Guild Members Chunk Structure

| Field       | Type                                                                  | Description                                                                                |
| ----------- | --------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |
| guild_id    | snowflake                                                             | the id of the guild                                                                        |
| members     | array of [guild member](/resources/guild#guild-member-object) objects | set of guild members                                                                       |
| chunk_index | integer                                                               | the chunk index in the expected chunks for this response (0 <= chunk_index < chunk_count)  |
| chunk_count | integer                                                               | the total number of expected chunks for this response                                      |
| not_found?  | array                                                                 | if passing an invalid id to `REQUEST_GUILD_MEMBERS`, it will be returned here              |
| presences?  | array of [presence](#presence) objects                                | if passing true to `REQUEST_GUILD_MEMBERS`, presences of the returned members will be here |
| nonce?      | string                                                                | the nonce used in the [Guild Members Request](#request-guild-members)                      |

#### Guild Role Create

Sent when a guild role is created.

###### Guild Role Create Structure

| Field    | Type                                             | Description         |
| -------- | ------------------------------------------------ | ------------------- |
| guild_id | snowflake                                        | the id of the guild |
| role     | a [role](/topics/permissions#role-object) object | the role created    |

#### Guild Role Update

Sent when a guild role is updated.

###### Guild Role Update Structure

| Field    | Type                                             | Description         |
| -------- | ------------------------------------------------ | ------------------- |
| guild_id | snowflake                                        | the id of the guild |
| role     | a [role](/topics/permissions#role-object) object | the role updated    |

#### Guild Role Delete

Sent when a guild role is deleted.

###### Guild Role Delete Structure

| Field    | Type      | Description     |
| -------- | --------- | --------------- |
| guild_id | snowflake | id of the guild |
| role_id  | snowflake | id of the role  |

### Guild Scheduled Event Create

Sent when a guild scheduled event is created. The inner payload is a [guild scheduled event](/resources/guild-scheduled-event#guild-scheduled-event-object) object.

### Guild Scheduled Event Update

Sent when a guild scheduled event is updated. The inner payload is a [guild scheduled event](/resources/guild-scheduled-event#guild-scheduled-event-object) object.

### Guild Scheduled Event Delete

Sent when a guild scheduled event is deleted. The inner payload is a [guild scheduled event](/resources/guild-scheduled-event#guild-scheduled-event-object) object.

### Guild Scheduled Event User Add

Sent when a user has subscribed to a guild scheduled event.

> info
> NOTE: this event is currently experimental and not officially supported

###### Guild Scheduled Event User Add Structure

| Field                    | Type      | Description                     |
| ------------------------ | --------- | ------------------------------- |
| guild_scheduled_event_id | snowflake | id of the guild scheduled event |
| user_id                  | snowflake | id of the user                  |
| guild_id                 | snowflake | id of the guild                 |

### Guild Scheduled Event User Remove

Sent when a user has unsubscribed from a guild scheduled event.

> info
> NOTE: this event is currently experimental and not officially supported

###### Guild Scheduled Event User Remove Structure

| Field                    | Type      | Description                     |
| ------------------------ | --------- | ------------------------------- |
| guild_scheduled_event_id | snowflake | id of the guild scheduled event |
| user_id                  | snowflake | id of the user                  |
| guild_id                 | snowflake | id of the guild                 |

### Integrations

#### Integration Create

Sent when an integration is created. The inner payload is an [integration](/resources/guild#integration-object) object with an additional `guild_id` key:

###### Integration Create Event Additional Fields

| Field    | Type      | Description     |
| -------- | --------- | --------------- |
| guild_id | snowflake | id of the guild |

#### Integration Update

Sent when an integration is updated. The inner payload is an [integration](/resources/guild#integration-object) object with an additional `guild_id` key:

###### Integration Update Event Additional Fields

| Field    | Type      | Description     |
| -------- | --------- | --------------- |
| guild_id | snowflake | id of the guild |

#### Integration Delete

Sent when an integration is deleted.

###### Integration Delete Structure

| Field           | Type      | Description                                                   |
| --------------- | --------- | ------------------------------------------------------------- |
| id              | snowflake | integration id                                                |
| guild_id        | snowflake | id of the guild                                               |
| application_id? | snowflake | id of the bot/OAuth2 application for this discord integration |

### Invites

#### Invite Create

Sent when a new invite to a channel is created. Requires the `MANAGE_CHANNELS` permission.

###### Invite Create Structure

| Field               | Type                                                                    | Description                                                                                                        |
| ------------------- | ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| channel_id          | snowflake                                                               | the channel the invite is for                                                                                      |
| code                | string                                                                  | the unique invite [code](/resources/invite#invite-object)                                                          |
| created_at          | ISO8601 timestamp                                                       | the time at which the invite was created                                                                           |
| guild_id?           | snowflake                                                               | the guild of the invite                                                                                            |
| inviter?            | partial [user](/resources/user#user-object) object                      | the user that created the invite                                                                                   |
| max_age             | integer                                                                 | how long the invite is valid for (in seconds)                                                                      |
| max_uses            | integer                                                                 | the maximum number of times the invite can be used                                                                 |
| target_type?        | integer                                                                 | the [type of target](/resources/invite#invite-target-types) for this voice channel invite                          |
| target_user?        | partial [user](/resources/user#user-object) object                      | the user whose stream to display for this voice channel stream invite                                              |
| target_application? | partial [application](/resources/application#application-object) object | the embedded application to open for this voice channel embedded application invite                                |
| temporary           | boolean                                                                 | whether or not the invite is temporary (invited users will be kicked on disconnect unless they're assigned a role) |
| uses                | integer                                                                 | how many times the invite has been used (always will be 0)                                                         |

#### Invite Delete

Sent when an invite is deleted. Requires the `MANAGE_CHANNELS` permission.

###### Invite Delete Structure

| Field      | Type      | Description                                               |
| ---------- | --------- | --------------------------------------------------------- |
| channel_id | snowflake | the channel of the invite                                 |
| guild_id?  | snowflake | the guild of the invite                                   |
| code       | string    | the unique invite [code](/resources/invite#invite-object) |

### Messages

<Alert type="warn">

Unlike persistent messages, ephemeral messages are sent directly to the user and the bot who sent the message rather than through the guild channel. Because of this, ephemeral messages are tied to the [`DIRECT_MESSAGES` intent](/topics/gateway#list-of-intents), and the message object won't include `guild_id` or `member`.

</Alert>

###### Message Object Extra Fields

| Field          | Type                                                                | Description                                                                                                                                    |
| -------------- | ------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| guild_id?\*    | snowflake                                                           | The ID of the guild the message was sent in                                                                                                    |
| member?\* \*\* | partial [guild member](/resources/guild#guild-member-object) object | Guild member data for this message's author                                                                                                    |
| mentions\*     | array[[user](/resources/user#user-object) object]                   | Users specifically mentioned in the message, with an extra [`member`](/resources/guild#guild-member-object) key representing guild member data |

\* Ephemeral messages will not include these fields.

\*\* Messages sent by webhooks will not include this field, as webhooks are not guild members.

#### Message Create

Sent when a message is created. The inner payload is a [message](/resources/message#message-object) object with the [extra Structure](#message-object-extra-fields) above.

#### Message Update

Sent when a message is updated. The inner payload is a [message](/resources/message#message-object) object with the [extra Structure](#message-object-extra-fields) above.

<Alert type="warn">

Unlike creates, message updates may contain only a subset of the full message object payload (but will always contain an `id` and `channel_id`).

</Alert>

#### Message Delete

Sent when a message is deleted.

###### Message Delete Structure

| Field      | Type      | Description           |
| ---------- | --------- | --------------------- |
| id         | snowflake | the id of the message |
| channel_id | snowflake | the id of the channel |
| guild_id?  | snowflake | the id of the guild   |

#### Message Delete Bulk

Sent when multiple messages are deleted at once.

###### Message Delete Bulk Structure

| Field      | Type                | Description             |
| ---------- | ------------------- | ----------------------- |
| ids        | array of snowflakes | the ids of the messages |
| channel_id | snowflake           | the id of the channel   |
| guild_id?  | snowflake           | the id of the guild     |

#### Message Reaction Add

Sent when a user adds a reaction to a message.

###### Message Reaction Add Structure

| Field      | Type                                                    | Description                                                                                   |
| ---------- | ------------------------------------------------------- | --------------------------------------------------------------------------------------------- |
| user_id    | snowflake                                               | the id of the user                                                                            |
| channel_id | snowflake                                               | the id of the channel                                                                         |
| message_id | snowflake                                               | the id of the message                                                                         |
| guild_id?  | snowflake                                               | the id of the guild                                                                           |
| member?    | [member](/resources/guild#guild-member-object) object   | the member who reacted if this happened in a guild                                            |
| emoji      | a partial [emoji](/resources/emoji#emoji-object) object | the emoji used to react - [example](/resources/emoji#gateway-reaction-standard-emoji-example) |

#### Message Reaction Remove

Sent when a user removes a reaction from a message.

###### Message Reaction Remove Structure

| Field      | Type                                                    | Description                                                        |
| ---------- | ------------------------------------------------------- | ------------------------------------------------------------------ |
| user_id    | snowflake                                               | the id of the user                                                 |
| channel_id | snowflake                                               | the id of the channel                                              |
| message_id | snowflake                                               | the id of the message                                              |
| guild_id?  | snowflake                                               | the id of the guild                                                |
| emoji      | a partial [emoji](/resources/emoji#emoji-object) object | the emoji used to react - [example](/resources/emoji#emoji-object) |

#### Message Reaction Remove All

Sent when a user explicitly removes all reactions from a message.

###### Message Reaction Remove All Structure

| Field      | Type      | Description           |
| ---------- | --------- | --------------------- |
| channel_id | snowflake | the id of the channel |
| message_id | snowflake | the id of the message |
| guild_id?  | snowflake | the id of the guild   |

#### Message Reaction Remove Emoji

Sent when a bot removes all instances of a given emoji from the reactions of a message.

###### Message Reaction Remove Emoji Structure

| Field      | Type                                                  | Description                |
| ---------- | ----------------------------------------------------- | -------------------------- |
| channel_id | snowflake                                             | the id of the channel      |
| guild_id?  | snowflake                                             | the id of the guild        |
| message_id | snowflake                                             | the id of the message      |
| emoji      | [partial emoji object](/resources/emoji#emoji-object) | the emoji that was removed |

### Presence

#### Presence Update

This event is sent when a user's presence or info, such as name or avatar, is updated. The inner payload is a [presence](/resources/presence#presence-object) object.

<Alert type="warn">

If you are using [Gateway Intents](/topics/gateway#gateway-intents), you _must_ specify the `GUILD_PRESENCES` intent in order to receive Presence Update events

</Alert>

<Alert type="warn">

The `user` object within this event can be very partial. The only field which is guaranteed is the `id` field, everything else is optional. Along with this limitation, no fields are required, and the types of the fields are **not** validated. Your client should expect any combination of fields and types within this event.

</Alert>

#### Typing Start

Sent when a user starts typing in a channel.

###### Typing Start Structure

| Field      | Type                                                  | Description                                               |
| ---------- | ----------------------------------------------------- | --------------------------------------------------------- |
| channel_id | snowflake                                             | id of the channel                                         |
| guild_id?  | snowflake                                             | id of the guild                                           |
| user_id    | snowflake                                             | id of the user                                            |
| timestamp  | integer                                               | unix time (in seconds) of when the user started typing    |
| member?    | [member](/resources/guild#guild-member-object) object | the member who started typing if this happened in a guild |

#### User Update

Sent when properties about the current user change. Inner payload is a [user](/resources/user#user-object) object.

### Voice

#### Voice State Update

Sent when someone joins/leaves/moves voice channels. Inner payload is a [voice state](/resources/voice#voice-state-object) object.

#### Voice Server Update

Sent when a guild or call's voice server is updated. This is sent when initially connecting to voice, and when the current voice instance fails over to a new server.

<Alert type="warn">

A `null` endpoint means that the voice server allocated has gone away and is trying to be reallocated. You should attempt to disconnect from the currently connected voice server, and not attempt to reconnect until a new voice server is allocated.

</Alert>

###### Voice Server Update Structure

| Field       | Type       | Description                                         |
| ----------- | ---------- | --------------------------------------------------- |
| token       | string     | The voice connection token                          |
| guild_id    | ?snowflake | The guild this voice server update is for           |
| channel_id? | snowflake  | The private channel this voice server update is for |
| endpoint    | ?string    | The voice server host                               |

###### Example Voice Server Update Payload

```json
{
  "token": "my_token",
  "guild_id": "41771983423143937",
  "endpoint": "smart.loyal.discord.media:443"
}
```

### Webhooks

#### Webhooks Update

Sent when a guild channel's webhook is created, updated, or deleted.

###### Webhooks Update Structure

| Field      | Type      | Description       |
| ---------- | --------- | ----------------- |
| guild_id   | snowflake | id of the guild   |
| channel_id | snowflake | id of the channel |

### Interactions

#### Interaction Create

Sent when a user uses an [Application Command](/interactions/application-commands/) or [Message Component](/interactions/message-components/). Inner payload is an [Interaction](/interactions/receiving-and-responding#interaction-structure).

### Stage Instances

#### Stage Instance Create

Sent when a [Stage instance](/resources/stage-instance) is created (i.e. the stage is now "live"). inner payload is a [stage instance](/resources/stage-instance#stage-instance-object)

#### Stage Instance Update

Sent when a [Stage instance](/resources/stage-instance) has been updated. inner payload is a [stage instance](/resources/stage-instance#stage-instance-object)

#### Stage Instance Delete

Sent when a [Stage instance](/resources/stage-instance) has been deleted (i.e. the stage has been closed). inner payload is a [stage instance](/resources/stage-instance#stage-instance-object)

## Session Start Limit Object

###### Session Start Limit Structure

| Field           | Type    | Description                                                        |
| --------------- | ------- | ------------------------------------------------------------------ |
| total           | integer | The total number of session starts the current user is allowed     |
| remaining       | integer | The remaining number of session starts the current user is allowed |
| reset_after     | integer | The number of milliseconds after which the limit resets            |
| max_concurrency | integer | The number of identify requests allowed per 5 seconds              |

## Endpoints

<RouteHeader method="GET" url="/gateway" unauthenticated>
  Get Gateway
</RouteHeader>

Returns an object with a single valid WebSocket URL, which the client can use for [Connecting](#connecting). Clients **should** cache this value and only call this endpoint to retrieve a new URL if they are unable to properly establish a connection using the cached version of the URL.

###### Response Body

| Field | Type   | Description                                                      |
| ----- | ------ | ---------------------------------------------------------------- |
| url   | string | The WebSocket URL that can be used for connecting to the Gateway |

###### Example Response

```json
{
  "url": "wss://gateway.discord.gg/"
}
```

<RouteHeader method="GET" url="/gateway/bot">
  Get Gateway Bot
</RouteHeader>

Returns an object based on the information in [Get Gateway](#get-gateway), plus additional metadata that can help during the operation of large or [sharded](#sharding) bots. Unlike [Get Gateway](#get-gateway), this route should not be cached for extended periods of time as the value is not guaranteed to be the same per-call, and changes as the user joins/leaves guilds.

###### JSON Response

| Field               | Type                                                      | Description                                                          |
| ------------------- | --------------------------------------------------------- | -------------------------------------------------------------------- |
| url                 | string                                                    | The WebSocket URL that can be used for connecting to the Gateway     |
| shards              | integer                                                   | The recommended number of [shards](#sharding) to use when connecting |
| session_start_limit | [session start limit](#session-start-limit-object) object | Information on the current session start limit                       |

###### Example Response

```json
{
  "url": "wss://gateway.discord.gg/",
  "shards": 9,
  "session_start_limit": {
    "total": 1000,
    "remaining": 999,
    "reset_after": 14400000,
    "max_concurrency": 1
  }
}
```

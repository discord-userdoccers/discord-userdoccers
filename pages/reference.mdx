import Snowflake from "../components/Snowflake.tsx";

# API Reference

Discord's API is based around two core layers, a HTTPS/REST API for general operations, and persistent secure WebSocket based connection for sending and subscribing to real-time events. The most common use case of the Discord API will be providing a service, or access to a platform through the [OAuth2](https://oauth.net/2/) API.

###### Base URL

<Alert type="info">

Discord offers a canary API for testing changes before they are pushed to the regular API. The canary API is not guaranteed to be stable, and can be used at the dedicated URL or [with debug options](#debugging).

</Alert>

```
Stable: https://discord.com/api
Canary: https://canary.discord.com/api
```

## API Versioning

<Alert type="danger">

Some API and Gateway versions are now non-functioning, and are labeled as discontinued in the table below for posterity. Trying to use these versions will fail and return 400 Bad Request.

</Alert>

Discord exposes different versions of the API[.](https://c.tenor.com/BuZl66EegkgAAAAC/westworld-dolores.gif) You should specify which version to use by including it in the request path like `https://discord.com/api/v{version_number}`. Omitting the version number from the route will route requests to the current default version (marked below).

###### API Versions

| Version | Status       | Default  |
| ------- | ------------ | -------- |
| 10      | Available    |          |
| 9       | Available    | ✓ Client |
| 8       | Deprecated   |          |
| 7       | Deprecated   |          |
| 6       | Deprecated   | ✓ API    |
| 5       | Discontinued |          |
| 4       | Discontinued |          |
| 3       | Discontinued |          |

## Error Messages

Starting in API v7, form error responses have improved error formatting. The response will tell you which JSON key contains the error, the error code, and a human readable error message. Discord is frequently adding new error messages, so a complete list of errors is not feasible and would be almost instantly out of date. Here are some examples instead:

###### Array Error

```json
{
  "code": 50035,
  "errors": {
    "activities": {
      "0": {
        "platform": {
          "_errors": [
            {
              "code": "BASE_TYPE_CHOICES",
              "message": "Value must be one of ('desktop', 'android', 'ios')."
            }
          ]
        },
        "type": {
          "_errors": [
            {
              "code": "BASE_TYPE_CHOICES",
              "message": "Value must be one of (0, 1, 2, 3, 4, 5)."
            }
          ]
        }
      }
    }
  },
  "message": "Invalid Form Body"
}
```

###### Object Error

```json
{
  "code": 50035,
  "errors": {
    "access_token": {
      "_errors": [
        {
          "code": "BASE_TYPE_REQUIRED",
          "message": "This field is required"
        }
      ]
    }
  },
  "message": "Invalid Form Body"
}
```

###### Request Error

```json
{
  "code": 50035,
  "message": "Invalid Form Body",
  "errors": {
    "_errors": [
      {
        "code": "APPLICATION_COMMAND_TOO_LARGE",
        "message": "Command exceeds maximum size (4000)"
      }
    ]
  }
}
```

## Authentication

Authenticating with the Discord API can be done in one of two ways:

1. Using a user or bot token gained by [logging into an account](/authentication) or [registering a bot](https://discord.com/developers/applications?new_application=true). For more information on users and bots, see [bots vs user accounts](/topics/oauth2#bot-vs-user-accounts).
2. Using an OAuth2 bearer token gained through the [OAuth2 API](/topics/oauth2#oauth2).

For all authentication types, authentication is performed with the `Authorization` HTTP header in the format `Authorization: TOKEN_TYPE? TOKEN`.

###### Example User Token Authorization Header

```
Authorization: MTk4NjIyNDgzNDcxOTI1MjQ4.Cl2FMQ.ZnCjm1XVW7vRze4b7Cq4se7kKWs
```

###### Example Bot Token Authorization Header

```
Authorization: Bot MTk4NjIyNDgzNDcxOTI1MjQ4.Cl2FMQ.ZnCjm1XVW7vRze4b7Cq4se7kKWs
```

###### Example Bearer Token Authorization Header

```
Authorization: Bearer CZhtkLDpNYXgPH9Ml6shqh2OwykChw
```

## Encryption

All HTTP-layer services and protocols (e.g. HTTP, WebSocket) within the Discord API are using TLS 1.2.

## Snowflake Format

Discord utilizes Twitter's [snowflake](https://github.com/twitter/snowflake/tree/snowflake-2010) format for uniquely identifiable descriptors (IDs). These IDs are guaranteed to be unique across all of Discord, except in some unique scenarios in which child objects share their parent's ID. Because Snowflake IDs are up to 64 bits in size (e.g. a uint64), they are always returned as strings in the HTTP API to prevent integer overflows in some languages. See [the Gateway documentation](/topics/gateway#encoding-and-compression) for more information regarding Gateway encoding.

###### Snowflake ID Broken Down in Binary

```
111111111111111111111111111111111111111111 11111 11111 111111111111
64                                         22    17    12          0
```

###### Snowflake ID Format Structure (Left to Right)

| Field               | Bits     | Number of bits | Description                                                                  | Retrieval                           |
| ------------------- | -------- | -------------- | ---------------------------------------------------------------------------- | ----------------------------------- |
| Timestamp           | 63 to 22 | 42 bits        | Milliseconds since Discord Epoch, the first second of 2015 or 1420070400000. | `(snowflake >> 22) + 1420070400000` |
| Internal worker ID  | 21 to 17 | 5 bits         |                                                                              | `(snowflake & 0x3E0000) >> 17`      |
| Internal process ID | 16 to 12 | 5 bits         |                                                                              | `(snowflake & 0x1F000) >> 12`       |
| Increment           | 11 to 0  | 12 bits        | For every ID that is generated on that process, this number is incremented   | `snowflake & 0xFFF`                 |

### Convert Snowflake to DateTime

<Snowflake />

### Snowflake IDs in Pagination

Discord typically uses snowflake IDs in many API routes for pagination. The standardized pagination paradigm utilized is one in which you can specify IDs `before` and `after` in combination with `limit` to retrieve a desired page of results. You will want to refer to the specific endpoint documentation for details.

It is useful to note that snowflake IDs are just numbers with a timestamp, so when dealing with pagination where you want results from the beginning of time (in Discord Epoch, but `0` works here too) or before/after a specific time you can generate a snowflake ID for that time.

<Alert type="info">

If the endpoint supports multiple pagination arguments, any `before`, `after`, and `around` keys are mutually exclusive (only one may be used at a time). If multiple are provided, only `around` or `before` is respected.

</Alert>

###### Generating a Snowflake ID from a Timestamp Example

```
(timestamp_ms - DISCORD_EPOCH) << 22
```

## ID Serialization

There are some cases in which the API and Gateway may return IDs in an unexpected format. Internally, Discord stores IDs as integer snowflakes. When IDs are serialized to JSON, `bigints` are transformed into strings. Given that all Discord IDs are snowflakes, you should always expect a string.

However, there are cases in which passing something to the API will instead return IDs serialized as an integer; this is the case when you send the API or Gateway a value in an `id` field that is not `bigint` size. For example, when requesting `GUILD_MEMBERS_CHUNK` from the gateway:

```js
// Send
{
  op: 8,
  d: {
    guild_id: [ '308994132968210433' ],
    user_ids: [ '123123' ]
  }
}

// Receive
{
  t: 'GUILD_MEMBERS_CHUNK',
  s: 3,
  op: 0,
  d: {
    not_found: [ 123123 ],
    members: [],
    guild_id: '308994132968210433'
  }
}
```

You can see in this case that the sent `user_id` is not a `bigint`; therefore, when it is serialized back to JSON by Discord, it is not transformed into a string. **This will never happen with IDs that come from Discord.** But, this can happen if you send malformed data in your requests.

## ISO8601 Date/Time

Discord utilizes the [ISO8601 format](https://www.loc.gov/standards/datetime/iso-tc154-wg5_n0038_iso_wd_8601-1_2016-02-16.pdf) for most Date/Times returned in the API. This format is referred to as type `ISO8601` within tables in this documentation.

## Consistency

Discord operates at a scale where true consistency is impossible. Because of this, lots of operations in the API and in-between API services are [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency). Due to this, client actions can never be serialized and may be executed in _any_ order (if executed at all). Along with these constraints, events in Discord may:

- Never be sent to a client
- Be sent _exactly_ one time to the client
- Be sent up to _N_ times per client

Clients should operate on events and results from the API in as much of an idempotent behavior as possible.

## HTTP API

### User Agent

Clients using the HTTP API should provide a valid [User Agent](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.43) which specifies information about the client library and version in the following format:

###### User Agent Example

```
User-Agent: DiscordBot ($url, $versionNumber)
```

Clients may append more information and metadata to the _end_ of this string as they wish.

### Rate Limiting

The HTTP API implements a process for limiting and preventing excessive requests in accordance with [RFC 6585](https://tools.ietf.org/html/rfc6585#section-4). API users that regularly hit and ignore rate limits will have their API keys revoked, and be blocked from the platform. For more information on rate limiting of requests, please see the [Rate Limits](/topics/rate-limits#rate-limits) section.

### Boolean Query Strings

Certain endpoints in the API are documented to accept booleans for their query string parameters. While there is no standard system for boolean representation in query string parameters, Discord represents such cases using `True`, `true`, or `1` for true and `False`, `false` or `0` for false.

### Debugging

The HTTP API accepts an optional `X-Debug-Options` header with a comma-delimited list of debug options. The options in this list can be arbitrary, but the below options have effects:

| Value  | Description                                            |
| ------ | ------------------------------------------------------ |
| canary | Forcefully routes the request to the canary API        |
| trace  | Forcefully [traces the request with APM](#apm-tracing) |

###### APM Tracing

Discord offers an APM (Application Performance Monitoring) service that allows Discord employees to view traces of requests made to the API. This is useful for debugging issues with the API, and can be enabled by setting `trace` in the `X-Debug-Options` header as described above.

When tracing requests, you must provide an additional `X-Client-Trace-ID` header with a unique identifier for the request. This identifier can be generated with the following pseudocode:

```py
import base64
import random
import struct
import time

class IDGenerator:
    def __init__(self):
        self.prefix = random.randint(0, 0xFFFFFFFF) & 0xFFFFFFFF
        self.creation_time = int(time.time() * 1000)
        self.sequence = 0

    def generate(self, user_id: int = 0):
        uuid = bytearray(24)
        # Lowest signed 32 bits
        struct.pack_into("<I", uuid, 0, user_id & 0xFFFFFFFF)
        struct.pack_into("<I", uuid, 4, user_id >> 32)
        struct.pack_into("<I", uuid, 8, self.prefix)
        # Lowest signed 32 bits
        struct.pack_into("<I", uuid, 12, self.creation_time & 0xFFFFFFFF)
        struct.pack_into("<I", uuid, 16, self.creation_time >> 32)
        struct.pack_into("<I", uuid, 20, self.sequence)
        self.sequence += 1
        return base64.b64encode(uuid).decode("utf-8")

if __name__ == "__main__":
    generator = IDGenerator()
    # Use 0 for user_id if you don't have one
    generator.generate(user_id or 0)
```

After the request is completed, the trace may be viewed by navigating to `https://app.datadoghq.com/apm/traces?query=@guid.x-client-trace-id:"{trace_id}"&showAllSpans=true` (replacing the `{trace_id}` with the value you provided).

<Alert type="info">

The ability to view APM traces is only available to Discord employees.

</Alert>

## Gateway API

Discord's Gateway API is used for maintaining persistent, stateful WebSocket connections between your client and Discord servers. These connections are used for sending and receiving real-time events your client can use to track and update local state. The Gateway API uses secure WebSocket connections as specified in [RFC 6455](https://tools.ietf.org/html/rfc6455). For information on opening Gateway connections, please see the [Gateway API](/topics/gateway#connections) section.

## Message Formatting

Discord utilizes a subset of markdown for rendering message content on its clients, while also adding some custom functionality to enable things like mentioning users and channels. This functionality uses the following formats:

###### Formats

| Type                    | Structure           | Example                       |
| ----------------------- | ------------------- | ----------------------------- |
| User                    | <@USER_ID>          | <@80351110224678912>          |
| User ^1^                | <@!USER_ID>         | <@!80351110224678912>         |
| Channel                 | <#CHANNEL_ID>       | <#103735883630395392>         |
| Role                    | <@&ROLE_ID>         | <@&165511591545143296>        |
| Slash Command ^2^       | </NAME:COMMAND_ID>  | </airhorn:816437322781949972> |
| Standard Emoji          | Unicode Characters  | 💯                            |
| Custom Emoji            | <:NAME:ID>          | <:mmLol:216154654256398347>   |
| Custom Emoji (Animated) | <a:NAME:ID>         | <a:b1nzy:392938283556143104>  |
| Unix Timestamp          | <t:TIMESTAMP>       | <t:1618953630>                |
| Unix Timestamp (Styled) | <t:TIMESTAMP:STYLE> | <t:1618953630:d>              |

Using the markdown for either users, roles, or channels will usually mention the target(s) accordingly, but this can be suppressed using the `allowed_mentions` parameter when creating a message. Standard emoji are currently rendered using [Twemoji](https://twemoji.twitter.com/) for Desktop/Android and Apple's native emoji on iOS.

Timestamps are expressed in seconds and display the given timestamp in the user's timezone and locale.

^1^ User mentions with an exclamation mark are deprecated and should be handled like any other user mention.

^2^ Subcommands and subcommand groups can also be mentioned by using respectively `</NAME SUBCOMMAND:ID>` and `</NAME SUBCOMMAND_GROUP SUBCOMMAND:ID>`.

###### Timestamp Styles

| Style | Example Output               | Description     |
| ----- | ---------------------------- | --------------- |
| t     | 16:20                        | Short Time      |
| T     | 16:20:30                     | Long Time       |
| d     | 20/04/2021                   | Short Date      |
| D     | 20 April 2021                | Long Date       |
| f ^1^ | 20 April 2021 16:20          | Short Date/Time |
| F     | Tuesday, 20 April 2021 16:20 | Long Date/Time  |
| R     | 2 months ago                 | Relative Time   |

^1^ This is the default.

## CDN Formatting

###### CDN Base URL

```
https://cdn.discordapp.com/
```

Discord uses IDs and hashes to render images and other CDN content in the client. These hashes can be retrieved through various API requests, like [Get User](/resources/user#get-user). Below are the formats, size limitations, and CDN endpoints for content in Discord. The returned format can be changed by changing the [extension name](#file-formats) at the end of the URL. For images, the returned size can be changed by appending a [query string](#cdn-parameters) of `?size=desired_size` to the URL. Image size can be any power of two between 16 and 4096, with some additional accepted values [outlined below](#cdn-parameters).

In the case of endpoints that support animated images, the hash will begin with `a_` if it is available in APNG or GIF format (e.g. `a_1269e74af4df7417b13759eae50c83dc`).

###### File Formats

| Name   | Extension   |
| ------ | ----------- |
| JPEG   | .jpg, .jpeg |
| PNG    | .png        |
| SVG    | .svg        |
| WebP   | .webp       |
| WebM   | .webm       |
| GIF    | .gif        |
| Lottie | .json       |
| MP3    | .mp3        |
| MP4    | .mp4        |
| OGG    | .ogg        |

###### CDN Endpoints

| Type                             | Path                                                                                                                                                                                                                                                                                  | Supports                  |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------- |
| Attachment                       | /attachments/[channel_id](/resources/channel#channel-object)/[message_id]/[attachment_id](/resources/message#attachment-object)/[attachment_filename](/resources/message#attachment-object) ^2^                                                                                       | Uploaded format ^4^       |
| Avatar Decoration Preset         | /avatar-decoration-presets/[avatar_decoration_data_asset](/resources/user#avatar-decoration-data-structure).png                                                                                                                                                                       | PNG, JPEG, WebP           |
| User Avatar                      | /avatars/[user_id](/resources/user#user-object)/[user_avatar](/resources/user#user-object).png                                                                                                                                                                                        | PNG, JPEG, WebP, GIF      |
| Default User Avatar              | /embed/avatars/[user_index](/resources/user#user-object).png ^1^ ^2^                                                                                                                                                                                                                  | PNG                       |
| User Banner                      | /banners/[user_id](/resources/user#user-object)/[user_banner](/resources/user#user-object).png                                                                                                                                                                                        | PNG, JPEG, WebP, GIF      |
| Channel Icon                     | /channels/[channel_id](/resources/channel#channel-object)/icons/[channel_icon](/resources/channel#channel-object).png                                                                                                                                                                 | PNG, JPEG, WebP           |
| Guild Icon                       | /icons/[guild_id](/resources/guild#guild-object)/[guild_icon](/resources/guild#guild-object).png                                                                                                                                                                                      | PNG, JPEG, WebP, GIF      |
| Guild Splash                     | /splashes/[guild_id](/resources/guild#guild-object)/[guild_splash](/resources/guild#guild-object).png                                                                                                                                                                                 | PNG, JPEG, WebP           |
| Guild Discovery Splash           | /discovery-splashes/[guild_id](/resources/guild#guild-object)/[guild_discovery_splash](/resources/guild#guild-object).png                                                                                                                                                             | PNG, JPEG, WebP           |
| Guild Banner                     | /banners/[guild_id](/resources/guild#guild-object)/[guild_banner](/resources/guild#guild-object).png                                                                                                                                                                                  | PNG, JPEG, WebP, GIF      |
| Guild Home Header                | /guilds/[guild_id](/resources/guild#guild-object)/home-headers/[guild_home_header](/resources/guild#guild-object).png                                                                                                                                                                 | PNG, JPEG, WebP           |
| Guild Scheduled Event Cover      | /guild-events/[scheduled_event_id](/resources/guild-scheduled-event#guild-scheduled-event-object)/[scheduled_event_cover_image](/resources/guild-scheduled-event#guild-scheduled-event-object).png                                                                                    | PNG, JPEG, WebP           |
| Guild Member Avatar              | /guilds/[guild_id](/resources/guild#guild-object)/users/[user_id](/resources/user#user-object)/avatars/[user_avatar](/resources/user#user-object).png                                                                                                                                 | PNG, JPEG, WebP, GIF      |
| Guild Member Banner              | /guilds/[guild_id](/resources/guild#guild-object)/users/[user_id](/resources/user#user-object)/banners/[user_banner](/resources/user#user-object).png                                                                                                                                 | PNG, JPEG, WebP, GIF      |
| Role Icon                        | /roles/[role_id](/topics/permissions#role-object)/icons/[role_icon](/topics/permissions#role-object).png                                                                                                                                                                              | PNG, JPEG, WebP           |
| Custom Emoji                     | /emojis/[emoji_id](/resources/emoji#emoji-object).png                                                                                                                                                                                                                                 | PNG, JPEG, WebP, GIF      |
| Application Icon                 | /app-icons/[application_id](/resources/application#application-object)/[icon](/resources/application#application-object).png                                                                                                                                                          | PNG, JPEG, WebP           |
| Application Cover                | /app-icons/[application_id](/resources/application#application-object)/[cover_image](/resources/application#application-object).png                                                                                                                                                   | PNG, JPEG, WebP           |
| Application Splash               | /app-icons/[application_id](/resources/application#application-object)/[splash](/resources/application#application-object).png                                                                                                                                                        | PNG, JPEG, WebP           |
| Application Asset                | /app-assets/[application_id](/resources/application#application-object)/[asset_id](/resources/application#application-asset-object).png                                                                                                                                               | PNG, JPEG, WebP           |
| Application Directory Collection | /application-directory/collection-items/item_id/item_hash.png                                                                                                                                                                                                                         | PNG, JPEG, WebP           |
| Achievement Icon                 | /app-assets/[application_id](/resources/application#application-object)/achievements/achievement_id/icons/icon_hash.png                                                                                                                                                               | PNG, JPEG, WebP           |
| Sticker Pack Banner              | /app-assets/710982414301790216/store/[sticker_pack_banner_asset_id](/resources/sticker#sticker-pack-object).png                                                                                                                                                                       | PNG, JPEG, WebP           |
| Team Icon                        | /team-icons/[team_id](/resources/team#team-object)/[team_icon](/resources/team#team-object).png                                                                                                                                                                                       | PNG, JPEG, WebP           |
| Sticker                          | /stickers/[sticker_id](/resources/sticker#sticker-object).png ^2^ ^3^                                                                                                                                                                                                                 | PNG, Lottie, GIF          |
| Soundboard Sounds                | /soundboard-sounds/sound_id                                                                                                                                                                                                                                                           | MP3, OGG                  |
| Video Filter                     | /users/[user_id](/resources/user#user-object)/video-filter-assets/video_filter_id/video_filter_asset.png                                                                                                                                                                              | PNG, JPEG, GIF, MP4, WEBP |
| Profile Badge                    | /badge-icons/[badge_icon](/resources/user#profile-badge-structure).png                                                                                                                                                                                                                | PNG                       |
| Quest Asset                      | /assets/quests/[quest_id](/resources/quests#quest-object)/[asset_name](/resources/quests#quest-assets-structure).png, /assets/quests/[quest_id](/resources/quests#quest-object)/[theme](/resources/user/#client-theme)/[asset_name](/resources/quests#quest-assets-structure).png ^5^ | PNG, JPEG, GIF, SVG, WebM |

^1^ In the case of the Default User Avatar endpoint, the value for `user_index` in the path for migrated users should be the user's ID shifted 22 bits to the left modulo 6 (i.e. `user_id >> 22 % 6`). The value for non-migrated users the user's discriminator modulo 5 (Test#1337 would be `1337 % 5`, which evaluates to 2). The value for teams should be the team's ID modulo 5 (i.e. `team_id % 5`). See the [section on Discord's new username system](/resources/user#unique-usernames) for more information.

^2^ In the case of the Attachment, Default User Avatar and Sticker endpoints, the size of images returned is constant with the `size` query string parameter being ignored.

^3^ In the case of the Sticker endpoint, the sticker will be available as PNG if its [`format_type`](/resources/sticker#sticker-object) is `PNG` or `APNG`, GIF if its [`format_type`](/resources/sticker#sticker-object) is `GIF`, and as [Lottie](https://airbnb.io/lottie/#/) if its [`format_type`](/resources/sticker#sticker-object) is `LOTTIE`.

^4^ In the case of the Attachment endpoint, the attachment will only be available in its uploaded format, which can be anything.

^5^ In the case of the Quest Asset endpoint, the [theme](/resources/user/#client-theme) path is only used for fetching the [`game_tile` and `logotype` assets](/resources/quests#quest-assets-structure).

##### CDN Parameters

The CDN supports various query string parameters. These parameters are optional and can be used to modify the returned resource. Parameters are only applicable to image resources.

| Field             | Type        | Description                                                                                                                                                                                                                                       |
| ----------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| size              | integer     | The size of the image to return (if omitted, a default size is used); the size can be any power of two between 16 and 4096, and additionally 20, 22, 24, 28, 40, 44, 48, 56, 60, 80, 96, 100, 160, 240, 300, 320, 480, 600, 640, 1280, 1536, 3072 |
| quality           | string      | The [quality](#image-quality) of the image to return; not supported with all endpoints and image types                                                                                                                                            |
| keep_aspect_ratio | boolean ^1^ | Whether the image will be resized to the endpoint's enforced aspect ratio (default false)                                                                                                                                                         |
| passthrough       | boolean ^1^ | Whether the image will be returned in the original, Discord-defined quality and format (usually APNG) if possible (default true); only supported with specific endpoints                                                                          |

^1^ The CDN only accepts boolean parameters as `true` or `false` (not `1` or `0`).

##### Image Quality

The quality of the image to return. Only supported with images of type WebP and JPG (the rest are always lossless). The quality can be any of the following values:

| Value    | Description                                                             |
| -------- | ----------------------------------------------------------------------- |
| lossless | The image will be returned in its original format, with no quality loss |
| high     | The image will be returned in a high quality format (the default)       |
| low      | The image will be returned in a low quality format                      |

### Signed Attachment URLs

Attachments uploaded to Discord's CDN (like user-uploaded images) have signed URLs with a preset expiry time. Discord automatically refreshes attachment CDN URLs that appear within the client, so when you receive a payload with a signed URL (like when you [fetch a message](/resources/message#get-messages)), it will be valid.

When passing CDN URLs into API fields, like [`url` in an embed image object](/resources/message#embed-image-structure) and [`avatar_url` for webhooks](/resources/webhook#execute-webhook), or when simply sending a message, you can pass the CDN URL without any parameters as the value and Discord will automatically render and refresh the URL.

If you need to refresh an attachment URL manually, you can use the [Refresh Attachment URLs](/resources/channel#refresh-attachment-urls) endpoint with any URL.

[Other CDN endpoints](#cdn-endpoints) listed above are not signed, so they will not expire.

###### Attachment URL Query Parameters

| Parameter | Description                                                     |
| --------- | --------------------------------------------------------------- |
| ex        | Hex timestamp indicating when an attachment CDN URL will expire |
| is        | Hex timestamp indicating when the URL was issued                |
| hm        | Unique signature that remains valid until the URL's expiration  |

###### Example Attachment URL

```
https://cdn.discordapp.com/attachments/1012345678900020080/1234567891233211234/my_image.png?ex=65d903de&is=65c68ede&hm=2481f30dd67f503f54d020ae3b5533b9987fae4e55f2b4e3926e08a3fa3ee24f&
```

## CDN Data

CDN data is a [Data URI scheme](https://en.wikipedia.org/wiki/Data_URI_scheme) that supports formats such as JPG, GIF, and PNG. An example Data URI format is:

```js
data: image / jpeg;
base64, BASE64_ENCODED_JPEG_IMAGE_DATA;
```

Ensure you use the proper content type (e.g. `image/jpeg`, `image/png`, `image/gif`) that matches the image data being provided.

## Uploading Files

<Alert type="info">

A file upload size limit applies to _all_ files in a request (rather than each individual file). While the limit depends on the [**premium tier (boost level)**](https://support.discord.com/hc/en-us/articles/360028038352-Server-Boosting-FAQ-#h_419c3bd5-addd-4989-b7cf-c7957ef92583) of a guild, it is 25 MiB by default.

</Alert>

Some endpoints support file attachments, indicated by the `files[n]` parameter. To add file(s), the standard `application/json` body must be replaced by a `multipart/form-data` body. The JSON message body can optionally be provided using the `payload_json` parameter.

All `files[n]` parameters must include a valid `Content-Disposition` subpart header with a `filename` and unique `name` parameter. Each file parameter must be uniquely named in the format `files[n]` such as `files[0]`, `files[1]`, or `files[42]`. The suffixed index `n` is the _snowflake placeholder_ that can be used in the `attachments` field, which can be passed to the `payload_json` parameter (or [Callback Data Payloads](/interactions/receiving-and-responding/#interaction-callback-data-structure)).

Images can also be referenced in embeds using the `attachment://filename` URL. The `filename` for these URLs must be ASCII alphanumeric with underscores, dashes, or dots. An example payload is provided below.

### Editing Message Attachments

The `attachments` JSON parameter includes all files that will be appended to the message, including new files and their respective snowflake placeholders (referenced above). When making a `PATCH` request, only files listed in the `attachments` parameter will be appended to the message. Any previously-added files that aren't included will be removed.

###### Example Request Bodies (multipart/form-data)

Note that these examples are small sections of an HTTP request to demonstrate behaviour of this endpoint - client libraries will set their own form boundaries (`boundary` is just an example). For more information, refer to the [multipart/form-data spec](https://tools.ietf.org/html/rfc7578#section-4).

This example demonstrates usage of the endpoint _without_ `payload_json`.

```json
--boundary
Content-Disposition: form-data; name="content"
Hello, World!
--boundary
Content-Disposition: form-data; name="tts"
true
--boundary--
```

This example demonstrates usage of the endpoint _with_ `payload_json` and all content fields (`content`, `embeds`, `files[n]`) set.

```json
--boundary
Content-Disposition: form-data; name="payload_json"
Content-Type: application/json
{
  "content": "Hello, World!",
  "embeds": [{
    "title": "Hello, Embed!",
    "description": "This is an embedded message.",
    "thumbnail": {
      "url": "attachment://myfile.png"
    },
    "image": {
      "url": "attachment://mygif.gif"
    }
  }],
  "message_reference": {
    "message_id": "233648473390448641"
  },
  "attachments": [{
      "id": 0,
      "description": "Image of a cute little cat",
      "filename": "myfile.png"
  }, {
      "id": 1,
      "description": "Rickroll gif",
      "filename": "mygif.gif"
  }]
}
--boundary
Content-Disposition: form-data; name="files[0]"; filename="myfile.png"
Content-Type: image/png
[image bytes]
--boundary
Content-Disposition: form-data; name="files[1]"; filename="mygif.gif"
Content-Type: image/gif
[image bytes]
--boundary--
```

###### Using Attachments within Embeds

You can upload attachments when creating a message and use those attachments within your embed. To do this, you will want to upload files as part of your `multipart/form-data` body. Make sure that you're uploading files which contain a filename, as you will need to reference it in your payload.

<Alert type="warn">

Only `.jpg`, `.jpeg`, `.png`, `.webp`, and `.gif` may be used at this time. Other file types are not supported.

</Alert>

Within an embed object, you can then set an image to use an attachment as its URL with the attachment scheme syntax: `attachment://filename.png`

For example:

```json
{
  "embeds": [
    {
      "image": {
        "url": "attachment://screenshot.png"
      }
    }
  ]
}
```

### Uploading to Google Cloud

You can upload large attachments quickly directly to Discord's Google Cloud storage bucket, using the [Create Attachments](/resources/message#create-attachments) endpoint to generate upload URLs, and sending each generated URL a `PUT` request with the intended attachment as the body.

When using Google Cloud uploads, the file upload size limit applies to individual files, rather than the entire request.

An example implementation in Python pseudocode would be:

```py
import requests
import os

url = "https://discord.com/api/v10/channels/<channel_id>/attachments"

headers = {
    "Authorization": "Bot <bot_token>"
}

filename = "index.js"
size = os.stat(filename).st_size

json = {
    "files": [{
        "file_size": size,
        "filename": filename
    }]
}

r = requests.post(url, headers=headers, json=json)
r.raise_for_status()

upload = r.json()['attachments'][0]
with open(filename, "r") as f:
    data = f.read()
    r = requests.put(upload['upload_url'], data=data)
    r.raise_for_status()

upload_filename = upload['upload_filename']
```

Now, instead of sending the attachment again in a form body in the request, you can just send the `upload_filename`! For example:

```json
{
  "content": "look at my cute cat!",
  "attachments": [
    {
      "id": "0",
      "filename": "cat.png",
      "uploaded_filename": "6a08e58a-265f-485a-8c85-5cd4df0edde0/cat.png"
    }
  ]
}
```

## Locales

| Locale | Language Name         | Native Name               |
| ------ | --------------------- | ------------------------- |
| ar     | Arabic                | العربية                   |
| bg     | Bulgarian             | български                 |
| cs     | Czech                 | Čeština                   |
| da     | Danish                | Dansk                     |
| de     | German                | Deutsch                   |
| el     | Greek                 | Ελληνικά                  |
| en-GB  | English, UK           | English, UK               |
| en-US  | English, US           | English, US               |
| es-ES  | Spanish               | Español                   |
| es-419 | Spanish, LATAM        | Español de América Latina |
| fi     | Finnish               | Suomi                     |
| fr     | French                | Français                  |
| hi     | Hindi                 | हिन्दी                    |
| hr     | Croatian              | Hrvatski                  |
| hu     | Hungarian             | Magyar                    |
| id     | Indonesian            | Bahasa Indonesia          |
| it     | Italian               | Italiano                  |
| ja     | Japanese              | 日本語                    |
| ko     | Korean                | 한국어                    |
| lt     | Lithuanian            | Lietuviškai               |
| nl     | Dutch                 | Nederlands                |
| no     | Norwegian             | Norsk                     |
| pl     | Polish                | Polski                    |
| pt-BR  | Portuguese, Brazilian | Português do Brasil       |
| ro     | Romanian              | Română                    |
| ru     | Russian               | Pусский                   |
| sv-SE  | Swedish               | Svenska                   |
| th     | Thai                  | ไทย                       |
| tr     | Turkish               | Türkçe                    |
| uk     | Ukrainian             | Українська                |
| vi     | Vietnamese            | Tiếng Việt                |
| zh-CN  | Chinese, China        | 中文                      |
| zh-TW  | Chinese, Taiwan       | 繁體中文                  |

## Documentation Reference

This documentation uses various conventions to describe the API. Here are some common conventions you may see:

### Nullable and Optional Resource Fields

Resource fields that may contain a `null` value have types that are prefixed with a question mark.  
Resource fields that are optional have names that are suffixed with a question mark.

<Alert type="info">

Resource fields that are `null`/missing only in extraneous cases will not be marked as above.
Instead, they will be marked with a footnote, and the situation will be explained below.

</Alert>

###### Example Nullable and Optional Fields

| Field                        | Type    |
| ---------------------------- | ------- |
| optional_field? ^1^          | string  |
| nullable_field               | ?string |
| optional_and_nullable_field? | ?string |

^1^ May be unexpectedly `null` at 3:00 AM on Tuesdays for accounts created on June 23rd, 2017.

### Deprecated/Removed Fields

Fields that are deprecated will be marked with a **(deprecated)** notice next to them. Fields that are removed (and are kept for completion's sake, such as in enums) will be ~~marked with strikethrough~~.

### Event Fields

Certain fields are only present in structures received over the Gateway. These fields will usually be documented in the Gateway section instead of the main structure.

### Badges

Certain endpoints may have badges that describe additional behavior in short form. Here are some examples you may find:

##### MFA Required

This endpoint may require that users with multi-factor authentication enabled authenticate themselves for certain actions. See the [MFA verification documentation](/authentication#mfa-verification) for implementation.

This is not applicable to OAuth2 and bot requests.

##### Audit Log Reason

The endpoint may be used with a `X-Audit-Log-Reason` header. This header is used to provide a reason for the action being performed. This reason will be shown in the audit log entry for this action. See the [audit log documentation](/resources/audit-log#audit-reason) for more information.

##### Unauthenticated Request

These requests do not require the `Authorization` header to be present.

##### OAuth2 Request

The endpoint may be used with a bearer token in the `Authorization` header. The specific scope required (if any) will be provided if you hover over the badge.

##### Deprecated Endpoint

This endpoint remains active and functionally the same, but it should be avoided if possible as it may be removed in a future API version.
